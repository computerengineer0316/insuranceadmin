"use strict";(self.webpackChunk_coreui_coreui_free_react_admin_template=self.webpackChunk_coreui_coreui_free_react_admin_template||[]).push([[2586],{12586:(e,a,t)=>{t.r(a),t.d(a,{default:()=>c});var n=t(65043),i=t(73216),s=t(70579);const c=()=>{const e=(0,i.Zp)(),[a,t]=(0,n.useState)([]),[c,d]=(0,n.useState)({}),[o,l]=(0,n.useState)([]),[r,h]=(0,n.useState)(""),[p,m]=(0,n.useState)(""),[_,u]=(0,n.useState)(""),x=window.location.href,j=new URLSearchParams(x.split("?")[1]),v=j.get("id"),f=j.get("type");(0,n.useEffect)((()=>{const a=localStorage.getItem("token");if(null===a||void 0===a||""===a)e("/login");else{const e=window.location.href.split("/")[3].split("?")[1].split("&"),a=e[0].split("=")[1],t=e[1].split("=")[1];g(a,t),m(t)}}),[]);const g=async(e,a)=>{await fetch(`https://insuranceapi-3o5t.onrender.com/api/get_additional_cover/${e}/${a}`,{method:"GET",headers:{"Content-Type":"application/json"}}).then((e=>e.json())).then((n=>{const i=n.data,s=i.length;let c="";"motor"==a&&(c=`https://insuranceapi-3o5t.onrender.com/api/motor_plan_details/${e}`),"travel"==a&&(c=`https://insuranceapi-3o5t.onrender.com/api/travel_plan_details/${e}`),"yacht"==a&&(c=`https://insuranceapi-3o5t.onrender.com/api/yacht_plan_details/${e}`),"home"==a&&(c=`https://insuranceapi-3o5t.onrender.com/api/home_plan_details/${e}`),"medical"==a&&(c=`https://insuranceapi-3o5t.onrender.com/api/single_medical_plan_details/${e}`),fetch(c,{method:"GET",headers:{"Content-Type":"application/json"}}).then((e=>e.json())).then((e=>{const a=e.data.additional_cover_arr;h(e.data.plan_name),u(e.company_name),console.log(a,"additional cover array");const n=[];for(let t=0;t<s;t++)for(let e=0;e<a.length;e++)i[t]._id==a[e].additional_cover_id&&(n.push(i[t]),i[t].checked="checked",i[t].value=a[e].additional_cover_value,i[t].additional_cover_description=a[e].additional_cover_desc),console.log(i);t(i),l(n)}))}))},b=(e,a)=>{const{name:t,value:n}=e.target;l((e=>{const i=[...e],s=i.findIndex((e=>e._id===a));return-1!==s?i[s]={...i[s],[t]:n}:i.push({_id:a,[t]:n}),i}))};return(0,s.jsx)("div",{className:"container",children:(0,s.jsx)("div",{className:"row",children:(0,s.jsx)("div",{className:"col-md-12",children:(0,s.jsxs)("div",{className:"card ",children:[(0,s.jsx)("div",{className:"card-header",children:(0,s.jsxs)("div",{className:"row",children:[(0,s.jsxs)("div",{className:"col-md-6",children:[(0,s.jsx)("h4",{children:"Additional Covers"}),"travel"==p?(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)("h5",{children:["Plan Name : ",r]}),(0,s.jsxs)("h5",{children:["Company Name : ",_]})]}):""]}),(0,s.jsx)("div",{className:"col-md-6",children:(0,s.jsx)("button",{onClick:()=>e(-1),className:"btn btn-primary",style:{float:"right"},children:"Back"})})]})}),(0,s.jsx)("div",{className:"card-body",children:(0,s.jsxs)("table",{className:"table table-bordered",children:[(0,s.jsx)("thead",{children:(0,s.jsxs)("tr",{children:[(0,s.jsx)("th",{children:(0,s.jsx)("strong",{children:"#"})}),(0,s.jsx)("th",{children:(0,s.jsx)("strong",{children:"Additional Cover Label"})}),(0,s.jsx)("th",{children:(0,s.jsx)("strong",{children:"Description"})}),(0,s.jsx)("th",{children:(0,s.jsx)("strong",{children:"Fixed/Percentage/Reffered"})})]})}),(0,s.jsx)("tbody",{children:a.map((e=>(0,s.jsxs)("tr",{children:[(0,s.jsx)("td",{children:(0,s.jsx)("div",{className:"checkboxs",children:(0,s.jsx)("input",{className:"form-check-input",type:"checkbox",id:"flexCheckDefault",defaultChecked:e.checked,onChange:a=>((e,a)=>{const t=[...o];if(console.log(t,">>>>before values"),!0===e.target.checked)a.checked="checked",t.push(a);else if(!1===e.target.checked){const e=t.indexOf(a);console.log(e),t.splice(e,1)}l(t),console.log(t,">>>>updated values")})(a,e)})})}),(0,s.jsx)("td",{children:e.additional_cover_label}),(0,s.jsx)("td",{children:(0,s.jsx)("div",{className:"form-group",children:(0,s.jsx)("input",{type:"text",name:"additional_cover_description",className:"form-control",disabled:!e.checked,onChange:a=>b(a,e._id),defaultValue:e.additional_cover_description})})}),(0,s.jsx)("td",{children:(0,s.jsx)("div",{className:"form-group",children:(0,s.jsx)("input",{type:"text",name:"value",className:"form-control",disabled:!e.checked,onChange:a=>b(a,e._id),defaultValue:e.value})})})]},e._id)))})]})}),(0,s.jsx)("div",{className:"card-footer",children:(0,s.jsx)("button",{className:"btn btn-primary",onClick:()=>{console.log(o,"submit data");for(var a=0;a<o.length;a++)if("checked"==o[a].checked&&(void 0===o[a].additional_cover_description||""===o[a].additional_cover_description))return alert("Please enter a description for data "+o[a].additional_cover_label),!1;const t={method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({id:v,type:f,formData:o})};fetch("https://insuranceapi-3o5t.onrender.com/api/add_plan_additional_cover",t).then((e=>e.json())).then((a=>{e(-1)}))},style:{float:"right"},children:"Submit"})})]})})})})}}}]);
//# sourceMappingURL=2586.4444cc1d.chunk.js.map