"use strict";(self.webpackChunk_coreui_coreui_free_react_admin_template=self.webpackChunk_coreui_coreui_free_react_admin_template||[]).push([[8797],{38797:(e,t,a)=>{a.r(t),a.d(t,{default:()=>p});var s=a(65043),o=a(53519),n=a(84217),i=a(14282),c=a(73216),l=a(92157),r=a.n(l),d=a(73023),h=a.n(d),m=a(54168),u=a(70579);const p=()=>{const e=(0,c.Zp)(),[t,a]=(0,s.useState)([]),[l,d]=(0,s.useState)([]),[p,j]=(0,s.useState)([]),[x]=(0,s.useState)(10),[g,b]=(0,s.useState)(0),[v,y]=(0,s.useState)(1),[N,k]=(0,s.useState)(""),[f,w]=(0,s.useState)(!1),[C,_]=(0,s.useState)("");(0,s.useEffect)((()=>{const t=localStorage.getItem("token");null===t||void 0===t||""===t?e("/login"):(S(v,x),L())}),[]);const L=async()=>{await fetch("https://insuranceapi-3o5t.onrender.com/api/get_location",{method:"GET",headers:{"Content-Type":"application/json"}}).then((e=>e.json())).then((e=>{const t=e.data,a=t.length,s=[];for(let o=0;o<a;o++){const e={label:t[o].location_name,value:t[o]._id};s.push(e)}d(s)}))};console.log(l);const S=async(e,t)=>{try{await fetch(`https://insuranceapi-3o5t.onrender.com/api/getWorkLocation?page=${e}&limit=${t}`).then((e=>e.json())).then((e=>{const s=e.total/t,o=Math.ceil(s);b(o);const n=e.data;a(n)}))}catch(s){console.log(s)}};console.log(t);const T=(v-1)*x,A=e=>{j(e)},W=async(e,t)=>{try{const a=await fetch(`https://insuranceapi-3o5t.onrender.com/api/updateWorkLocationstatus?id=${e}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({status:t})}),s=await a.json();200==s.status&&(h()({text:s.message,icon:"success",button:!1}),setTimeout((()=>{h().close()}),1e3),S(v,x))}catch(a){console.log(a)}};return(0,u.jsxs)(u.Fragment,{children:[(0,u.jsx)(o.A,{children:(0,u.jsxs)("div",{className:"card mb-4",children:[(0,u.jsx)("div",{className:"card-header",children:(0,u.jsxs)("div",{className:"row",children:[(0,u.jsx)("div",{className:"col-md-6",children:(0,u.jsx)("h4",{className:"card-title",children:"Work Location"})}),(0,u.jsx)("div",{className:"col-md-6",children:(0,u.jsx)("button",{className:"btn btn-primary",style:{float:"right"},onClick:()=>e("/AddWorklocation"),children:"Add Work Location"})})]})}),(0,u.jsxs)("div",{className:"card-body",children:[(0,u.jsxs)("table",{className:"table table-bordered",children:[(0,u.jsx)("thead",{className:"thead-dark",children:(0,u.jsxs)("tr",{className:"table-info",children:[(0,u.jsx)("th",{scope:"col",children:"#"}),(0,u.jsx)("th",{scope:"col",children:"Work Location"}),(0,u.jsx)("th",{scope:"col",children:"Location"}),(0,u.jsx)("th",{scope:"col",children:"Action"})]})}),(0,u.jsx)("tbody",{children:(null===t||void 0===t?void 0:t.length)>0?null===t||void 0===t?void 0:t.map(((e,t)=>{var a;return(0,u.jsxs)("tr",{children:[(0,u.jsx)("td",{children:T+t+1}),(0,u.jsx)("td",{children:e.worklocation}),(0,u.jsx)("td",{children:null===(a=e.location)||void 0===a?void 0:a.map((e=>e.location_name)).join(", ")}),(0,u.jsxs)("td",{children:[(0,u.jsx)("button",{className:"btn btn-primary",onClick:()=>(async e=>{console.log(e),console.log("i was clicked"),k(e);let t=await fetch(`https://insuranceapi-3o5t.onrender.com/api/getWorkLocationId?id=${e}`,{method:"get",headers:{"Content-Type":"application/json"}});t=await t.json(),_(t.data[0].worklocation);const a=t.data[0].location.map((e=>({label:e.location_name,value:e._id})));j(a),A(a),w(!0)})(e._id),children:"Edit"})," ",1==e.status?(0,u.jsx)("button",{className:"btn btn-danger",onClick:()=>{window.confirm("Are you sure you wish to deactivate this item?")&&W(e._id,0)},children:"Deactivate"}):(0,u.jsx)("button",{className:"btn btn-success",onClick:()=>{window.confirm("Are you sure you wish to activate this item?")&&W(e._id,1)},children:"Activate"})," ",(0,u.jsx)("button",{className:"btn btn-warning",onClick:()=>{window.confirm("Are you sure you wish to delete this item?")&&(async e=>{try{const t=await fetch(`https://insuranceapi-3o5t.onrender.com/api/deleteWorkLocation?id=${e}`,{method:"DELETE",headers:{"Content-Type":"application/json"}}),a=await t.json();200==a.status&&(h()({text:a.message,icon:"success",button:!1}),setTimeout((()=>{h().close()}),1e3),S(v,x))}catch(t){console.log(t)}})(e._id)},children:"Delete"})]})]},t)})):(0,u.jsx)("tr",{children:(0,u.jsx)("td",{colSpan:"6",children:"No Data Found"})})})]}),(0,u.jsx)(r(),{previousLabel:"Previous",nextLabel:"Next",breakLabel:"...",pageCount:g,marginPagesDisplayed:2,pageRangeDisplayed:3,onPageChange:e=>{const t=e.selected;y(t+1),S(t+1,x)},containerClassName:"pagination justify-content-end",pageClassName:"page-item",pageLinkClassName:"page-link",previousClassName:"page-item",previousLinkClassName:"page-link",nextClassName:"page-item",nextLinkClassName:"page-link",breakClassName:"page-item",breakLinkClassName:"page-link",activeClassName:"active"})]})]})}),(0,u.jsxs)(n.A,{size:"lg",show:f,onHide:()=>w(!1),children:[(0,u.jsx)(n.A.Header,{closeButton:!0,children:(0,u.jsx)(n.A.Title,{children:"Edit Work Location"})}),(0,u.jsx)(n.A.Body,{children:(0,u.jsx)("div",{className:"container",children:(0,u.jsx)("div",{className:"row",children:(0,u.jsx)("div",{className:"col-md-12",children:(0,u.jsx)("div",{className:"card",children:(0,u.jsx)("div",{className:"card-body",children:(0,u.jsxs)("form",{action:"/",method:"POST",onSubmit:async e=>{e.preventDefault();try{const t=e.target.worklocation.value,a=p.map((e=>e.value));if(""===t)return void h()({text:"Please enter sponsor type",icon:"warning"});if(0===p.length)return void h()({text:"Please select location",icon:"warning"});const s=await fetch(`https://insuranceapi-3o5t.onrender.com/api/updateWorkLocation?id=${N}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({worklocation:t,location:a})}),o=await s.json();200==o.status&&(h()({text:o.message,icon:"success",button:!1}),setTimeout((()=>{h().close()}),1e3),w(!1),S(v,x))}catch(t){console.log(t)}},children:[(0,u.jsxs)("div",{className:"row",children:[(0,u.jsxs)("div",{className:"col-md-6",children:[(0,u.jsx)("label",{className:"form-label",children:(0,u.jsx)("strong",{children:"Edit Work Location"})}),(0,u.jsx)("input",{type:"text",className:"form-control",name:"worklocation",placeholder:"Sponsor Type",defaultValue:C,autoComplete:"off",required:!0})]}),(0,u.jsxs)("div",{className:"col-md-6",children:[(0,u.jsx)("label",{className:"form-label",children:(0,u.jsx)("strong",{children:"Location"})}),(0,u.jsx)(m.default,{options:l,selectedValues:p,onSelect:A,onRemove:A,displayValue:"label",placeholder:"Select Location",closeOnSelect:!1,avoidHighlightFirstOption:!0,showCheckbox:!0,style:{chips:{background:"#007bff"}},required:!0})]})]}),(0,u.jsxs)("div",{className:"row",children:[(0,u.jsx)("div",{className:"col-md-12"}),(0,u.jsx)("div",{className:"col-md-12",children:(0,u.jsx)("button",{type:"submit",className:"btn btn-primary mt-2 submit_all",style:{float:"right"},children:"Submit"})})]})]})})})})})})}),(0,u.jsx)(n.A.Footer,{children:(0,u.jsx)(i.A,{variant:"secondary",onClick:()=>w(!1),children:"Close"})})]})]})}}}]);
//# sourceMappingURL=8797.e8cb9a1b.chunk.js.map