"use strict";(self.webpackChunk_coreui_coreui_free_react_admin_template=self.webpackChunk_coreui_coreui_free_react_admin_template||[]).push([[2743],{62743:(e,t,n)=>{n.r(t),n.d(t,{default:()=>c});var d=n(65043),l=n(73216),s=n(73023),o=n.n(s),i=n(70579);const c=()=>{const e=(0,l.Zp)(),[t,n]=(0,d.useState)([]),[s,c]=(0,d.useState)([]),[a,u]=(0,d.useState)(""),[r,m]=(0,d.useState)({});(0,d.useEffect)((()=>{let t=localStorage.getItem("token");if(""===t||null===t||void 0===t)e("/login");else{h();const e=window.location.href.split("/")[3].split("?")[1].split("=")[1];_(e),u(e)}}),[]);const h=()=>{fetch("https://insuranceapi-3o5t.onrender.com/api/getmodule",{method:"GET",headers:{"Content-Type":"application/json"}}).then((e=>e.json())).then((e=>{n(e.data)}))},_=e=>{fetch(`https://insuranceapi-3o5t.onrender.com/api/update_user_permission/${e}`,{method:"PUT",headers:{"Content-Type":"application/json"}}).then((e=>e.json())).then((e=>{const t=p(e.data);let n={};null===t||void 0===t||t.map((e=>{const t=[],d=null===e||void 0===e?void 0:e.permission[0];for(const n in d)"__v"!=n&&"_id"!=n&&"user_type_id"!=n&&(7==d[n].length?t.push(!0):t.push(!1));t.includes(!1)?n[e.module_name]=!1:n[e.module_name]=!0})),m(n);const d=JSON.stringify(t,null,2);c(JSON.parse(d))}))},p=e=>{const t=[];for(const n in e[0]){const d=e[0][n][0],l=n.split("_")[0],s={module_name:l.charAt(0).toUpperCase()+l.slice(1),permission:[{...d,_id:"64a3b25ba1f5ea6cfdbad390",__v:0}]};t.push(s)}return t},x=(e,t,d)=>{const l=d.target.checked;n((n=>n.map((n=>({...n,sub_module:n.sub_module.map((n=>n.sub_module_name===e?{...n,[t]:l?1:0}:n))}))))),c((n=>n.map((n=>{if(n.module_name===e){return{...n,permission:[{...n.permission[0],[e]:[t]}]}}return n}))))},j=async t=>{try{const n={method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)},d=await fetch(`https://insuranceapi-3o5t.onrender.com/api/update_user_permission_manually/${a}`,n),l=await d.json();200===l.status?o()({title:"Success!",text:l.message,type:"success",icon:"success"}).then((()=>{e("/User_management?id="+a)})):o()({title:"Error!",text:l.message,type:"error",icon:"error"}).then((()=>{e("/User_management?id="+a)}))}catch(n){console.log(n)}};return(0,i.jsx)("div",{className:"table-container",children:(0,i.jsxs)("div",{className:"table-container",children:[(0,i.jsxs)("table",{className:"table table-bordered admin_abcdsd",children:[(0,i.jsx)("thead",{children:(0,i.jsxs)("tr",{children:[(0,i.jsx)("th",{children:"Module"}),(0,i.jsx)("th",{children:"Task And Activity"}),(0,i.jsx)("th",{children:"Create"}),(0,i.jsx)("th",{children:"Edit"}),(0,i.jsx)("th",{children:"Delete"}),(0,i.jsx)("th",{children:"View"}),(0,i.jsx)("th",{children:"Download"}),(0,i.jsx)("th",{children:"Export"}),(0,i.jsx)("th",{children:"Upload"})]})}),(0,i.jsx)("tbody",{children:t.flatMap(((e,t)=>(0,i.jsxs)("tr",{children:[(0,i.jsxs)("td",{children:[(0,i.jsx)("p",{children:e.module_name}),"Select All",(0,i.jsx)("input",{className:"mx-2",defaultChecked:r[e.module_name],onClick:t=>((e,t)=>{let n=e.sub_module;const d=["create","edit","delete","view","download","export","upload"],l={target:{checked:t.target.checked}};let s=e._id;for(let o=0;o<(null===n||void 0===n?void 0:n.length);o++){const e=n[o];document.getElementById(s+o+"create").checked=t.target.checked,document.getElementById(s+o+"edit").checked=t.target.checked,document.getElementById(s+o+"delete").checked=t.target.checked,document.getElementById(s+o+"view").checked=t.target.checked,document.getElementById(s+o+"download").checked=t.target.checked,document.getElementById(s+o+"export").checked=t.target.checked,document.getElementById(s+o+"upload").checked=t.target.checked;for(let t=0;t<d.length;t++)x(e.sub_module_name,d[t],l)}})(e,t),type:"checkbox"})]}),(0,i.jsx)("td",{children:(0,i.jsx)("ul",{children:e.sub_module.map(((e,t)=>(0,i.jsx)("li",{children:e.sub_module_name},t)))})}),(0,i.jsx)("td",{children:(0,i.jsx)("ul",{children:e.sub_module.map(((t,n)=>(0,i.jsx)("li",{children:(0,i.jsx)("input",{type:"checkbox",id:e._id+n+"create",defaultChecked:s.filter((t=>t.module_name===e.module_name)).flatMap((e=>{const n=t.sub_module_name.toLowerCase().split(" ").join("_"),d=e.permission[0];return!(!d||!d[n])&&d[n].includes("create")}))[0],onClick:e=>x(t.sub_module_name,"create",e)})},n)))})}),(0,i.jsx)("td",{children:(0,i.jsx)("ul",{children:e.sub_module.map(((t,n)=>(0,i.jsx)("li",{children:(0,i.jsx)("input",{type:"checkbox",id:e._id+n+"edit",defaultChecked:s.filter((t=>t.module_name===e.module_name)).flatMap((e=>{const n=t.sub_module_name.toLowerCase().split(" ").join("_"),d=e.permission[0];return!(!d||!d[n])&&d[n].includes("edit")}))[0],onClick:e=>x(t.sub_module_name,"edit",e)})},n)))})}),(0,i.jsx)("td",{children:(0,i.jsx)("ul",{children:e.sub_module.map(((t,n)=>(0,i.jsx)("li",{children:(0,i.jsx)("input",{type:"checkbox",id:e._id+n+"delete",defaultChecked:s.filter((t=>t.module_name===e.module_name)).flatMap((e=>{const n=t.sub_module_name.toLowerCase().split(" ").join("_"),d=e.permission[0];return!(!d||!d[n])&&d[n].includes("delete")}))[0],onClick:e=>x(t.sub_module_name,"delete",e)})},n)))})}),(0,i.jsx)("td",{children:(0,i.jsx)("ul",{children:e.sub_module.map(((t,n)=>(0,i.jsx)("li",{children:(0,i.jsx)("input",{type:"checkbox",id:e._id+n+"view",defaultChecked:s.filter((t=>t.module_name===e.module_name)).flatMap((e=>{const n=t.sub_module_name.toLowerCase().split(" ").join("_"),d=e.permission[0];return!(!d||!d[n])&&d[n].includes("view")}))[0],onClick:e=>x(t.sub_module_name,"view",e)})},n)))})}),(0,i.jsx)("td",{children:(0,i.jsx)("ul",{children:e.sub_module.map(((t,n)=>(0,i.jsx)("li",{children:(0,i.jsx)("input",{type:"checkbox",id:e._id+n+"download",defaultChecked:s.filter((t=>t.module_name===e.module_name)).flatMap((e=>{const n=t.sub_module_name.toLowerCase().split(" ").join("_"),d=e.permission[0];return!(!d||!d[n])&&d[n].includes("download")}))[0],onClick:e=>x(t.sub_module_name,"download",e)})},n)))})}),(0,i.jsx)("td",{children:(0,i.jsx)("ul",{children:e.sub_module.map(((t,n)=>(0,i.jsx)("li",{children:(0,i.jsx)("input",{type:"checkbox",id:e._id+n+"export",defaultChecked:s.filter((t=>t.module_name===e.module_name)).flatMap((e=>{const n=t.sub_module_name.toLowerCase().split(" ").join("_"),d=e.permission[0];return!(!d||!d[n])&&d[n].includes("export")}))[0],onClick:e=>x(t.sub_module_name,"export",e)})},n)))})}),(0,i.jsx)("td",{children:(0,i.jsx)("ul",{children:e.sub_module.map(((t,n)=>(0,i.jsx)("li",{children:(0,i.jsx)("input",{type:"checkbox",id:e._id+n+"upload",defaultChecked:s.filter((t=>t.module_name===e.module_name)).flatMap((e=>{const n=t.sub_module_name.toLowerCase().split(" ").join("_"),d=e.permission[0];return!(!d||!d[n])&&d[n].includes("upload")}))[0],onClick:e=>x(t.sub_module_name,"upload",e)})},n)))})})]},t)))})]}),(0,i.jsx)("button",{className:"btn btn-primary",onClick:()=>{const e={};t.forEach((t=>{const n=[];t.sub_module.forEach((e=>{const t={[e.sub_module_name]:[]};Object.entries(e).forEach((n=>{let[d,l]=n;"sub_module_name"!==d&&t[e.sub_module_name].push({key:d,value:l?1:0})})),n.push(t)})),e[t.module_name]=n})),j(e)},style:{float:"right",marginTop:"10px"},children:"Submit"})]})})}}}]);
//# sourceMappingURL=2743.5a2eaa07.chunk.js.map