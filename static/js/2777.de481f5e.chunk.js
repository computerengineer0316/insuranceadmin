"use strict";(self.webpackChunk_coreui_coreui_free_react_admin_template=self.webpackChunk_coreui_coreui_free_react_admin_template||[]).push([[2777],{92777:(e,t,n)=>{n.r(t),n.d(t,{default:()=>c});var a=n(65043),o=n(73216),s=n(30064),l=n.n(s),i=n(54168),r=n(70579);const c=()=>{const e=(0,o.Zp)(),[t,n]=(0,a.useState)([]),[s,c]=(0,a.useState)([]),[d,p]=(0,a.useState)([]),[m,u]=(0,a.useState)([]),[h,_]=(0,a.useState)([]),[j,x]=(0,a.useState)([]),[f,v]=(0,a.useState)(""),[g,y]=(0,a.useState)(""),[N,b]=(0,a.useState)(""),[T,C]=(0,a.useState)(""),[S,w]=(0,a.useState)(""),[P,O]=(0,a.useState)(""),[E,V]=(0,a.useState)([]),[q,A]=(0,a.useState)([]),[D,k]=(0,a.useState)([]),[F,G]=(0,a.useState)({status:!1,name:""});(0,a.useEffect)((()=>{const t=localStorage.getItem("token");if(null===t||void 0===t||""===t)e("/login");else{const e=window.location.href.split("/")[3].split("?")[1].split("=")[1];O(e),I(),W(),J(),L(),Z(),$(),R(),z(e)}}),[]);const I=()=>{fetch("https://insuranceapi-3o5t.onrender.com/api/company_list",{method:"GET",headers:{"Content-Type":"application/json"}}).then((e=>e.json())).then((e=>{n(e.data)}))},R=()=>{fetch("https://insuranceapi-3o5t.onrender.com/api/get_location",{method:"GET",headers:{"Content-Type":"application/json"}}).then((e=>e.json())).then((e=>{const t=e.data,n=[];for(let a=0;a<t.length;a++)n.push({label:t[a].location_name,value:t[a]._id});k(n)}))},W=()=>{fetch("https://insuranceapi-3o5t.onrender.com/api/getTravelInsuranceFor",{method:"GET",headers:{"Content-Type":"application/json"}}).then((e=>e.json())).then((e=>{c(e.data)}))},J=()=>{fetch("https://insuranceapi-3o5t.onrender.com/api/travelcovertype",{method:"GET",headers:{"Content-Type":"application/json"}}).then((e=>e.json())).then((e=>{p(e.data)}))},L=()=>{fetch("https://insuranceapi-3o5t.onrender.com/api/getNatureOfPlan",{method:"GET",headers:{"Content-Type":"application/json"}}).then((e=>e.json())).then((e=>{u(e.data)}))},Z=()=>{fetch("https://insuranceapi-3o5t.onrender.com/api/getTravelType",{method:"GET",headers:{"Content-Type":"application/json"}}).then((e=>e.json())).then((e=>{_(e.data)}))},$=()=>{fetch("https://insuranceapi-3o5t.onrender.com/api/getNationality",{method:"GET",headers:{"Content-Type":"application/json"}}).then((e=>e.json())).then((e=>{const t=e.data,n=[];for(let a=0;a<t.length;a++)n.push({country_name:t[a].nationality_name,_id:t[a]._id});x(n)}))},z=e=>{fetch(`https://insuranceapi-3o5t.onrender.com/api/travel_plan_details/${e}`,{method:"GET",headers:{"Content-Type":"application/json"}}).then((e=>e.json())).then((e=>{var t;V(e.data);const n=e.data.country_or_topup;A(null===(t=e.data)||void 0===t?void 0:t.location);const a=n.length,o=[],s=[];for(let j=0;j<a;j++){const e={country_id:n[j].country_id,country_name:n[j].country_name};o.push(e);const t=n[j].countrytopup;s.push(t)}var l=o,i=s.join(",");v(l),y(i);const r=e.data.add_op_con_desc,c=r.length,d=[],p=[],m=[];for(let j=0;j<c;j++){const e=r[j].add_op_con_desc;d.push(e);const t=r[j].add_op_con_desc_topup;p.push(t);const n=r[j].vat;m.push(n)}var u=d.join(","),h=p.join(","),_=m.join(",");b(u),C(h),w(_)}))},B=e=>{v(e)},H=e=>{A(e)},U=e=>{const t=e.target.value;/^[A-Za-z,]*$/.test(t)?G({status:!1,name:e.target.name}):(G({status:!0,name:e.target.name}),e.target.value=t.replace(/[^a-zA-Z\s,]/g,""))};return(0,r.jsx)("div",{className:"container",children:(0,r.jsx)("div",{className:"row",children:(0,r.jsx)("div",{className:"col-md-12",children:(0,r.jsxs)("div",{className:"card",style:{marginTop:"20px"},children:[(0,r.jsx)("div",{className:"card-header",children:(0,r.jsxs)("div",{className:"row",children:[(0,r.jsx)("div",{className:"col-md-6",children:(0,r.jsx)("h4",{className:"card-title",children:"Edit Travel Plan"})}),(0,r.jsx)("div",{className:"col-md-6",children:(0,r.jsx)("button",{onClick:()=>e(-1),className:"btn btn-primary",style:{float:"right"},children:"Back"})})]})}),(0,r.jsx)("div",{className:"card-body",children:(0,r.jsxs)("form",{action:"/",method:"POST",onSubmit:t=>{t.preventDefault();const n=new FormData(t.target),a=n.get("company_id"),o=n.get("plan_name"),s=n.get("plan_type"),i=n.get("plan_category_id"),r=n.get("nature_of_plan_id"),c=n.get("travel_type_id"),d=n.get("countrytopup"),p=n.get("add_op_con_desc"),m=n.get("add_op_con_desc_topup"),u=n.get("vat"),h=n.get("jdv_comm");if(0!=f.length){let e=null===d||void 0===d?void 0:d.split(",");if(f.length!=e.length)return l().fire({title:"Warning!",text:"Please enter Country  Topup equal to Country",icon:"warning",button:!1}),!1}if(""!=p){if(""==m)return l().fire({title:"Warning!",text:"Please enter Topup (Add Option Condition Description)",icon:"warning",button:!1}),!1;if(""==u)return l().fire({title:"Warning!",text:"Please enter Vat",icon:"warning",button:!1}),!1;{const e=p.split(","),t=m.split(","),n=u.split(",");if(e.length!=t.length)return l().fire({title:"Warning!",text:"Please enter Topup (Add Option Condition Description) equal to Add Option Condition Description",icon:"warning",button:!1}),!1;if(e.length!=n.length)return l().fire({title:"Warning!",text:"Please enter Vat equal to Add Option Condition Description",icon:"warning",button:!1}),!1}}if(0===q.length)return l().fire({title:"Warning!",text:"Please Select Location",icon:"warning",button:!1}),!1;const _={method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({company_id:a,plan_name:o,plan_type:s,plan_category_id:i,nature_of_plan_id:r,travel_type_id:c,country:f,countrytopup:d,add_op_con_desc:p,add_op_con_desc_topup:m,vat:u,jdv_comm:h,location:q})};fetch(`https://insuranceapi-3o5t.onrender.com/api/updateTravelPlan/${P}`,_).then((e=>e.json())).then((t=>{200===t.status?(l().fire({title:"Success",text:t.message,icon:"success",button:!1}),e("/travel-plan"),setTimeout((()=>{l().close()}),1e3)):(l().fire({title:"Error!",text:t.message,icon:"error",button:!1}),e("/travel-plan"),setTimeout((()=>{l().close()}),1e3))}))},children:[(0,r.jsxs)("div",{className:"row",children:[(0,r.jsx)("div",{className:"col-md-4",children:(0,r.jsxs)("div",{className:"form-group mb-3",children:[(0,r.jsx)("label",{children:"Company Name"}),(0,r.jsxs)("select",{required:!0,className:"form-control",name:"company_id",children:[(0,r.jsx)("option",{value:"",children:"Select Company"}),t.map(((e,t)=>(0,r.jsx)("option",{value:e._id,selected:E.company_id==e._id,children:e.company_name},t)))]})]})}),(0,r.jsx)("div",{className:"col-md-4",children:(0,r.jsxs)("div",{className:"form-group mb-3",children:[(0,r.jsx)("label",{children:"Travel Insurance For"}),(0,r.jsxs)("select",{required:!0,className:"form-control",name:"plan_type",children:[(0,r.jsx)("option",{value:"",children:"Select Travel Insurance For"}),s.map(((e,t)=>(0,r.jsx)("option",{value:e._id,selected:E.travel_insurance_for_id==e._id,children:e.travel_insurance_for},t)))]})]})}),(0,r.jsx)("div",{className:"col-md-4",children:(0,r.jsxs)("div",{className:"form-group mb-3",children:[(0,r.jsx)("label",{children:"Plan Name"}),(0,r.jsx)("input",{required:!0,type:"text",className:"form-control",placeholder:"Enter Plan Name",name:"plan_name",autoComplete:"off",defaultValue:E.plan_name})]})})]}),(0,r.jsxs)("div",{className:"row",children:[(0,r.jsx)("div",{className:"col-md-4",children:(0,r.jsxs)("div",{className:"form-group mb-3",children:[(0,r.jsx)("label",{children:"Cover Type"}),(0,r.jsxs)("select",{required:!0,className:"form-control",name:"plan_category_id",children:[(0,r.jsx)("option",{value:"",children:"Select Cover Type"}),d.map(((e,t)=>(0,r.jsx)("option",{value:e._id,selected:E.plan_category_id==e._id,children:e.travel_cover_type},t)))]})]})}),(0,r.jsx)("div",{className:"col-md-4",children:(0,r.jsxs)("div",{className:"form-group mb-3",children:[(0,r.jsx)("label",{children:"Nature Of Plan"}),(0,r.jsxs)("select",{required:!0,className:"form-control",name:"nature_of_plan_id",children:[(0,r.jsx)("option",{value:"",children:"Select Nature Of Plan"}),m.map(((e,t)=>(0,r.jsx)("option",{value:e._id,selected:E.nature_of_plan_id==e._id,children:e.nature_of_plan_name},t)))]})]})}),(0,r.jsx)("div",{className:"col-md-4",children:(0,r.jsxs)("div",{className:"form-group mb-3",children:[(0,r.jsx)("label",{children:"Travel Type"}),(0,r.jsxs)("select",{required:!0,className:"form-control",name:"travel_type_id",children:[(0,r.jsx)("option",{value:"",children:"Select Travel Type"}),h.map(((e,t)=>(0,r.jsx)("option",{value:e._id,selected:E.travel_type_id==e._id,children:e.travel_type},t)))]})]})})]}),(0,r.jsxs)("div",{className:"row",children:[(0,r.jsx)("div",{className:"col-md-6",children:(0,r.jsxs)("div",{className:"form-group mb-3",children:[(0,r.jsx)("label",{children:"Country"}),(0,r.jsx)(i.default,{options:j,selectedValues:f,displayValue:"country_name",showCheckbox:!0,onSelect:B,onRemove:B})]})}),(0,r.jsx)("div",{className:"col-md-6",children:(0,r.jsxs)("div",{className:"form-group mb-3",children:[(0,r.jsx)("label",{children:"Fixed/Percentage/Reffered (Country)"}),(0,r.jsx)("input",{required:f.length>0,type:"text",name:"countrytopup",className:"form-control",placeholder:"Enter Fixed/Percentage/Reffered (Country)",autoComplete:"off",defaultValue:g})]})})]}),(0,r.jsxs)("div",{className:"row",children:[(0,r.jsx)("div",{className:"col-md-4",children:(0,r.jsxs)("div",{className:"form-group mb-3",children:[(0,r.jsx)("label",{children:"Add Option Condition Description"}),(0,r.jsx)("input",{type:"text",name:"add_op_con_desc",onInput:e=>U(e),className:"form-control",placeholder:"Enter Add Option Condition Description",autoComplete:"off",defaultValue:N}),1==F.status&&"add_op_con_desc"==F.name?(0,r.jsx)("span",{style:{color:"red"},children:"Text Only"}):""]})}),(0,r.jsx)("div",{className:"col-md-4",children:(0,r.jsxs)("div",{className:"form-group mb-3",children:[(0,r.jsx)("label",{children:"Fixed/Percentage/Reffered (Add Option Condition Description)"}),(0,r.jsx)("input",{type:"text",name:"add_op_con_desc_topup",className:"form-control",placeholder:"Enter Fixed/Percentage/Reffered (Add Option Condition Description)",autoComplete:"off",defaultValue:T})]})}),(0,r.jsx)("div",{className:"col-md-4",children:(0,r.jsxs)("div",{className:"form-group mb-3",children:[(0,r.jsx)("label",{children:"Vat Able"}),(0,r.jsx)("input",{type:"text",name:"vat",onInput:e=>U(e),className:"form-control",placeholder:"Enter Vat Able",autoComplete:"off",defaultValue:S}),1==F.status&&"vat"==F.name?(0,r.jsx)("span",{style:{color:"red"},children:"Text Only"}):""]})})]}),(0,r.jsx)("div",{className:"row",children:(0,r.jsx)("div",{className:"col-md-6",children:(0,r.jsxs)("div",{className:"form-group mb-3",children:[(0,r.jsx)("label",{children:"JDV Commission"}),(0,r.jsx)("input",{required:!0,type:"text",name:"jdv_comm",className:"form-control",placeholder:"Enter JDV Commission",autoComplete:"off",defaultValue:E.jdv_comm})]})})}),(0,r.jsx)("div",{className:"row",children:(0,r.jsx)("div",{className:"col-md-6",children:(0,r.jsxs)("div",{className:"form-group mb-3",children:[(0,r.jsx)("label",{children:"Location"}),(0,r.jsx)(i.default,{options:D,selectedValues:q,onSelect:e=>H(e),onRemove:e=>H(e),displayValue:"label",placeholder:"Select Location",closeOnSelect:!1,avoidHighlightFirstOption:!0,showCheckbox:!0,style:{chips:{background:"#007bff"}},required:!0})]})})}),(0,r.jsx)("div",{className:"row",children:(0,r.jsx)("div",{className:"col-md-12",children:(0,r.jsx)("button",{type:"submit",className:"btn btn-primary mt-2",style:{float:"right"},children:"Update"})})})]})})]})})})})}}}]);
//# sourceMappingURL=2777.de481f5e.chunk.js.map