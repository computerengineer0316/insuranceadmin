(self.webpackChunk_coreui_coreui_free_react_admin_template=self.webpackChunk_coreui_coreui_free_react_admin_template||[]).push([[2645],{72645:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>h});var n=s(65043),o=s(73216),a=s(92157),i=s.n(a),l=s(73023),c=s.n(l),r=(s(413),s(93946),s(72450),s(54168)),d=s(84217),m=s(14282),u=s(70579);const h=()=>{var e;const t=(0,o.Zp)(),[s,a]=(0,n.useState)([]),[l]=(0,n.useState)(20),[h,p]=(0,n.useState)(0),[f,x]=(0,n.useState)(1),[b,j]=(0,n.useState)([]),[v,g]=(0,n.useState)([]),[N,y]=(0,n.useState)(""),[w,_]=(0,n.useState)(!1),[S,C]=(0,n.useState)(!1),[T,k]=(0,n.useState)(!1),[E,A]=(0,n.useState)([]),[L,B]=(0,n.useState)(""),[O,R]=(0,n.useState)([]),[D,q]=(0,n.useState)(),[U,H]=(0,n.useState)(""),[M,F]=(0,n.useState)("");(0,n.useEffect)((()=>{const e=localStorage.getItem("token");if(null===e||void 0===e||""===e)t("/login");else{var s;P(f,l),V(),G();const e=JSON.parse(localStorage.getItem("user")),t=(null===e||void 0===e||null===(s=e.master_permission)||void 0===s?void 0:s[0])||{};A(t)}}),[]);const P=(e,t)=>{a([]);fetch(`https://insuranceapi-3o5t.onrender.com/api/getAllBusinessEntityComissions?page=${e}&limit=${t}`,{method:"GET",headers:{"Content-Type":"application/json"}}).then((e=>e.json())).then((e=>{B(e.message);const s=e.count/t,n=Math.ceil(s);p(n);const o=e.data;console.log(o,">>>>> list"),a(o)}))},V=()=>{const e=JSON.parse(localStorage.getItem("user")).line_of_business;if(e.length>0){const t=e,s=t.length,n=[];for(let e=0;e<s;e++){const s={label:t[e].lob_name,value:t[e].lob_id};n.push(s)}R(n)}else{fetch("https://insuranceapi-3o5t.onrender.com/api/get_line_of_business_list",{method:"GET",headers:{"Content-Type":"application/json"}}).then((e=>e.json())).then((e=>{const t=e.data,s=t.length,n=[];for(let o=0;o<s;o++){const e={label:t[o].line_of_business_name,value:t[o]._id};n.push(e)}R(n)}))}},G=()=>{fetch("https://insuranceapi-3o5t.onrender.com/api/get_location",{method:"GET",headers:{"Content-Type":"application/json"}}).then((e=>e.json())).then((e=>{const t=e.data,s=t.length,n=[];for(let o=0;o<s;o++)if("Head Office"!=t[o].location_name){const e={label:t[o].location_name,value:t[o]._id};n.push(e)}j(n),g(n)}))},J=(e,t)=>{const s={method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({be_status:t,id:e})};fetch("https://insuranceapi-3o5t.onrender.com/api/UpdateBusinessEntityComissionStatus",s).then((e=>e.json())).then((e=>{200===e.status?(c()({text:e.message,icon:"success",button:!1}),P(f,l),setTimeout((()=>{c().close()}),"1000")):(c()({title:"Error!",text:e.message,icon:"error",button:!1}),P(f,l),setTimeout((()=>{c().close()}),"1000"))}))},[$,I]=(0,n.useState)([]),z=e=>{I(e)},X=(f-1)*l;return(0,u.jsxs)(u.Fragment,{children:[(0,u.jsx)("div",{className:"container",children:(0,u.jsx)("div",{className:"row",children:(0,u.jsx)("div",{className:"col-md-12",children:(0,u.jsxs)("div",{className:"card",children:[(0,u.jsx)("div",{className:"card-header",children:(0,u.jsxs)("div",{className:"row",children:[(0,u.jsx)("div",{className:"col-md-6",children:(0,u.jsx)("h4",{className:"card-title",children:"BE Commission"})}),(0,u.jsx)("div",{className:"col-md-6",children:null!==(e=E.be_commission)&&void 0!==e&&e.includes("create")?(0,u.jsx)("button",{className:"btn btn-primary",style:{float:"right"},onClick:()=>(G(),void C(!0)),children:"Add BE Commission"}):""})]})}),(0,u.jsx)("div",{className:"card-body",children:(0,u.jsxs)("div",{className:"table-responsive",children:[(0,u.jsxs)("table",{className:"table table-bordered",children:[(0,u.jsx)("thead",{className:" text-primary",children:(0,u.jsxs)("tr",{children:[(0,u.jsx)("th",{children:"#"}),(0,u.jsx)("th",{children:"LOB"}),(0,u.jsx)("th",{children:"Description"}),(0,u.jsx)("th",{children:"Location"}),(0,u.jsx)("th",{children:"Rate"}),(0,u.jsx)("th",{children:"Action"})]})}),(0,u.jsx)("tbody",{children:s&&s.length>0?(0,u.jsx)(u.Fragment,{children:null===s||void 0===s?void 0:s.map(((e,t)=>{var s,n,o,a;return(0,u.jsxs)("tr",{children:[(0,u.jsx)("td",{children:X+t+1}),(0,u.jsx)("td",{children:null===(s=e.lobDetails)||void 0===s?void 0:s.map((e=>e.line_of_business_name)).join(", ")}),(0,u.jsx)("td",{children:e.desciption}),(0,u.jsx)("td",{children:null===(n=e.location_rate)||void 0===n?void 0:n.map((e=>e.location_name)).join(", ")}),(0,u.jsx)("td",{children:e.rate}),(0,u.jsxs)("td",{children:[(null===(o=E.be_commission)||void 0===o?void 0:o.includes("edit"))&&(0,u.jsx)("button",{className:"btn btn-primary",onClick:()=>{return t=e._id,y(t),void fetch(`https://insuranceapi-3o5t.onrender.com/api/getSingleBusinessEntityComission?id=${t}`,{method:"GET",headers:{"Content-Type":"application/json"}}).then((e=>e.json())).then((e=>{const t=e.data;console.log(t,">>>>>>>>>>>>>>>>>>"),H(t.desciption),F(t.rate);const s=t.location_rate.map((e=>({label:e.location_name,value:e.location_id})));g(s),I(s),q(t.lob),k(!0)}));var t},children:"Edit"})," ",(null===(a=E.be_commission)||void 0===a?void 0:a.includes("delete"))&&(0,u.jsxs)(u.Fragment,{children:[!0===e.status?(0,u.jsx)("button",{className:"btn btn-danger",onClick:()=>{window.confirm("Are you sure you wish to deactivate this item?")&&J(e._id,!1)},children:"Deactivate"}):(0,u.jsx)("button",{className:"btn btn-success",onClick:()=>{window.confirm("Are you sure you wish to activate this item?")&&J(e._id,!0)},children:"Activate"}),(0,u.jsx)("button",{className:"btn btn-warning mx-1",onClick:()=>{window.confirm("Are you sure you wish to delete this item?")&&(async e=>{await fetch(`https://insuranceapi-3o5t.onrender.com/api/deleteMasterData?id=${e}&type=becommission`,{method:"DELETE",headers:{"Content-Type":"application/json"}}).then((e=>e.json())).then((e=>{200===e.status?(c()({title:"Success!",text:e.message,icon:"success",button:!1}),P(f,l),setTimeout((()=>{c().close()}),1e3)):(c()({title:"Error!",text:e.message,icon:"error",button:!1}),P(f,l),setTimeout((()=>{c().close()}),1e3))}))})(e._id)},children:"Delete"})]})]})]},t)}))}):(0,u.jsx)("tr",{children:(0,u.jsx)("td",{colSpan:"17",style:{textAlign:"center"},children:(0,u.jsx)("strong",{children:L})})})})]}),(0,u.jsx)(i(),{previousLabel:"Previous",nextLabel:"Next",breakLabel:"...",pageCount:h,marginPagesDisplayed:2,pageRangeDisplayed:3,onPageChange:e=>{const t=e.selected;x(t+1),P(t+1,l)},containerClassName:"pagination justify-content-end",pageClassName:"page-item",pageLinkClassName:"page-link",previousClassName:"page-item",previousLinkClassName:"page-link",nextClassName:"page-item",nextLinkClassName:"page-link",breakClassName:"page-item",breakLinkClassName:"page-link",activeClassName:"active"})]})})]})})})}),(0,u.jsxs)(d.A,{size:"lg",show:S,onHide:()=>C(!1),children:[(0,u.jsx)(d.A.Header,{closeButton:!0,children:(0,u.jsx)(d.A.Title,{children:"Add BE Commission"})}),(0,u.jsx)(d.A.Body,{children:(0,u.jsx)("div",{className:"container",children:(0,u.jsx)("div",{className:"row",children:(0,u.jsx)("div",{className:"col-md-12",children:(0,u.jsx)("div",{className:"card",children:(0,u.jsx)("div",{className:"card-body",children:(0,u.jsxs)("form",{action:"/",method:"POST",onSubmit:e=>{try{e.preventDefault();const t=new FormData(e.target),s=t.get("description"),n=t.get("lob"),o=t.get("rate"),a=v,i=o.includes(",")?o.split(","):[o];if(console.log(a.length," : ",i.length),0==a.length||a==[]||void 0==a)c()("Please select location","","warning");else if(a.length!=i.length)c()("rate must be equal to Locations selected","","warning");else{console.log("ready to submit");const e={method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({desciption:s,rate:o,lob:n,location_rate:null===a||void 0===a?void 0:a.map((e=>({id:e.value,location_name:e.label})))})};fetch("https://insuranceapi-3o5t.onrender.com/api/addBusinessEntityComission",e).then((e=>e.json())).then((e=>{201==e.status?(C(!1),c()({text:e.message,type:"success",icon:"success",button:!1}),P(f,l),setTimeout((()=>{c().close()}),1e3)):(C(!1),c()({text:e.message,type:"error",icon:"error",button:!1}),P(f,l),setTimeout((()=>{c().close()}),1e3))}))}}catch(t){console.log(t)}},children:[(0,u.jsxs)("div",{className:"row",children:[(0,u.jsx)("div",{className:"col-md-6",children:(0,u.jsxs)("div",{className:"form-group",children:[(0,u.jsx)("label",{className:"form-label",children:"Select Line Of Business"}),(0,u.jsxs)("select",{className:"form-control",name:"lob",required:!0,children:[(0,u.jsx)("option",{value:"",children:"Select Line Of Buisness"}),null===O||void 0===O?void 0:O.map(((e,t)=>(0,u.jsx)("option",{value:e.value,children:e.label},t)))]})]})}),(0,u.jsx)("div",{className:"col-md-6",children:(0,u.jsxs)("div",{className:"form-group",children:[(0,u.jsx)("label",{className:"form-label",children:"Description"}),(0,u.jsx)("input",{type:"text",className:"form-control",name:"description",placeholder:"Description",autoComplete:"off",required:!0})]})}),(0,u.jsx)("div",{className:"col-md-6",children:(0,u.jsxs)("div",{className:"form-group",children:[(0,u.jsx)("label",{className:"form-label",children:"Location"}),(0,u.jsx)(r.default,{options:b,selectedValues:b,displayValue:"label",onSelect:g,onRemove:g,placeholder:"Select Location",showArrow:!0,showCheckbox:!0,required:!0})]})}),(0,u.jsx)("div",{className:"col-md-6",children:(0,u.jsxs)("div",{className:"form-group",children:[(0,u.jsx)("label",{className:"form-label",children:"Rate(%)"}),(0,u.jsx)("input",{type:"text",className:"form-control",name:"rate",placeholder:"Rate",autoComplete:"off",required:!0})]})})]}),(0,u.jsx)("div",{className:"row",children:(0,u.jsx)("div",{className:"col-md-12",children:(0,u.jsx)("button",{type:"submit",className:"btn btn-primary mt-2 submit_all",style:{float:"right"},children:"Submit"})})})]})})})})})})}),(0,u.jsx)(d.A.Footer,{children:(0,u.jsx)(m.A,{variant:"secondary",onClick:()=>C(!1),children:"Close"})})]}),(0,u.jsxs)(d.A,{size:"lg",show:T,onHide:()=>k(!1),children:[(0,u.jsx)(d.A.Header,{closeButton:!0,children:(0,u.jsx)(d.A.Title,{children:"Edit BE Commission"})}),(0,u.jsx)(d.A.Body,{children:(0,u.jsx)("div",{className:"container",children:(0,u.jsx)("div",{className:"row",children:(0,u.jsx)("div",{className:"col-md-12",children:(0,u.jsx)("div",{className:"card",children:(0,u.jsx)("div",{className:"card-body",children:(0,u.jsxs)("form",{action:"/",method:"POST",onSubmit:e=>{e.preventDefault();const t=new FormData(e.target),s=t.get("be_desc"),n=t.get("be_rate"),o=t.get("lob"),a=$,i=n.includes(",")?n.split(","):[n];if(console.log(a.length," : ",i.length),0==a.length||a==[]||void 0==a)c()("Please select location","","warning");else if(i.length!=a.length)c()("rate must be equal to Locations selected","","warning");else{const e={method:"put",headers:{"Content-Type":"application/json"},body:JSON.stringify({desciption:s,rate:n,location_rate:null===a||void 0===a?void 0:a.map((e=>({id:e.value,location_name:e.label}))),lob:o})};fetch(`https://insuranceapi-3o5t.onrender.com/api/UpdateBusinessEntityComission?id=${N}`,e).then((e=>e.json())).then((e=>{200===e.status?(k(!1),c()({text:e.message,icon:"success",button:!1}),P(f,l),setTimeout((()=>{c().close()}),1e3)):(k(!1),c()({title:"Error!",text:e.message,icon:"error",button:!1}),P(f,l),setTimeout((()=>{c().close()}),1e3))}))}},children:[(0,u.jsxs)("div",{className:"row",children:[(0,u.jsx)("div",{className:"col-md-6",children:(0,u.jsxs)("div",{className:"form-group",children:[(0,u.jsx)("label",{className:"form-label",children:"Line Of Business"}),(0,u.jsxs)("select",{className:"form-control",name:"lob",required:!0,children:[(0,u.jsx)("option",{value:"",children:"Select Line Of Buisness"}),null===O||void 0===O?void 0:O.map(((e,t)=>(0,u.jsx)("option",{selected:e.value==D,value:e.value,children:e.label},t)))]})]})}),(0,u.jsx)("div",{className:"col-md-6",children:(0,u.jsxs)("div",{className:"form-group",children:[(0,u.jsx)("label",{className:"form-label",children:"Description"}),(0,u.jsx)("input",{type:"text",className:"form-control",name:"be_desc",placeholder:"Description",defaultValue:U,autoComplete:"off",required:!0})]})}),(0,u.jsx)("div",{className:"col-md-6",children:(0,u.jsxs)("div",{className:"form-group",children:[(0,u.jsx)("label",{className:"form-label",children:"Location"}),(0,u.jsx)(r.default,{options:b,selectedValues:v,displayValue:"label",onSelect:z,onRemove:z,placeholder:"Select Location",showCheckbox:!0,required:!0})]})}),(0,u.jsx)("div",{className:"col-md-6",children:(0,u.jsxs)("div",{className:"form-group",children:[(0,u.jsx)("label",{className:"form-label",children:"Rate(%)"}),(0,u.jsx)("input",{type:"text",className:"form-control",name:"be_rate",placeholder:"Rate",defaultValue:M,autoComplete:"off",required:!0})]})})]}),(0,u.jsx)("div",{className:"row",children:(0,u.jsx)("div",{className:"col-md-12",children:(0,u.jsx)("button",{type:"submit",className:"btn btn-primary mt-2 submit_all",style:{float:"right"},children:"Update"})})})]})})})})})})}),(0,u.jsx)(d.A.Footer,{children:(0,u.jsx)(m.A,{variant:"secondary",onClick:()=>k(!1),children:"Close"})})]})]})}},72450:function(e,t,s){var n,o,a;o=[],void 0===(a="function"===typeof(n=function(){"use strict";function t(e,t){return"undefined"==typeof t?t={autoBom:!1}:"object"!=typeof t&&(console.warn("Deprecated: Expected third argument to be a object"),t={autoBom:!t}),t.autoBom&&/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(e.type)?new Blob(["\ufeff",e],{type:e.type}):e}function n(e,t,s){var n=new XMLHttpRequest;n.open("GET",e),n.responseType="blob",n.onload=function(){c(n.response,t,s)},n.onerror=function(){console.error("could not download file")},n.send()}function o(e){var t=new XMLHttpRequest;t.open("HEAD",e,!1);try{t.send()}catch(e){}return 200<=t.status&&299>=t.status}function a(e){try{e.dispatchEvent(new MouseEvent("click"))}catch(n){var t=document.createEvent("MouseEvents");t.initMouseEvent("click",!0,!0,window,0,0,0,80,20,!1,!1,!1,!1,0,null),e.dispatchEvent(t)}}var i="object"==typeof window&&window.window===window?window:"object"==typeof self&&self.self===self?self:"object"==typeof s.g&&s.g.global===s.g?s.g:void 0,l=i.navigator&&/Macintosh/.test(navigator.userAgent)&&/AppleWebKit/.test(navigator.userAgent)&&!/Safari/.test(navigator.userAgent),c=i.saveAs||("object"!=typeof window||window!==i?function(){}:"download"in HTMLAnchorElement.prototype&&!l?function(e,t,s){var l=i.URL||i.webkitURL,c=document.createElement("a");t=t||e.name||"download",c.download=t,c.rel="noopener","string"==typeof e?(c.href=e,c.origin===location.origin?a(c):o(c.href)?n(e,t,s):a(c,c.target="_blank")):(c.href=l.createObjectURL(e),setTimeout((function(){l.revokeObjectURL(c.href)}),4e4),setTimeout((function(){a(c)}),0))}:"msSaveOrOpenBlob"in navigator?function(e,s,i){if(s=s||e.name||"download","string"!=typeof e)navigator.msSaveOrOpenBlob(t(e,i),s);else if(o(e))n(e,s,i);else{var l=document.createElement("a");l.href=e,l.target="_blank",setTimeout((function(){a(l)}))}}:function(e,t,s,o){if((o=o||open("","_blank"))&&(o.document.title=o.document.body.innerText="downloading..."),"string"==typeof e)return n(e,t,s);var a="application/octet-stream"===e.type,c=/constructor/i.test(i.HTMLElement)||i.safari,r=/CriOS\/[\d]+/.test(navigator.userAgent);if((r||a&&c||l)&&"undefined"!=typeof FileReader){var d=new FileReader;d.onloadend=function(){var e=d.result;e=r?e:e.replace(/^data:[^;]*;/,"data:attachment/file;"),o?o.location.href=e:location=e,o=null},d.readAsDataURL(e)}else{var m=i.URL||i.webkitURL,u=m.createObjectURL(e);o?o.location=u:location.href=u,o=null,setTimeout((function(){m.revokeObjectURL(u)}),4e4)}});i.saveAs=c.saveAs=c,e.exports=c})?n.apply(t,o):n)||(e.exports=a)},413:(e,t,s)=>{"use strict";e.exports=s.p+"static/media/motor-make.b21b29b3a03d12061f79.xlsx"}}]);
//# sourceMappingURL=2645.8fdcafed.chunk.js.map