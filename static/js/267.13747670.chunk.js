"use strict";(self.webpackChunk_coreui_coreui_free_react_admin_template=self.webpackChunk_coreui_coreui_free_react_admin_template||[]).push([[267],{30267:(e,t,s)=>{s.r(t),s.d(t,{default:()=>h});var l=s(65043),a=s(53519),i=s(84217),o=s(14282),n=s(73216),r=(s(92157),s(73023)),d=s.n(r),c=s(54168),m=s(86213),u=s(70579);const h=()=>{const e=(0,n.Zp)(),[t,s]=(0,l.useState)([]),[r,h]=(0,l.useState)(!1),[v,p]=(0,l.useState)(!1),[x,j]=(0,l.useState)([]),[f,b]=(0,l.useState)([]),[y,g]=(0,l.useState)([]),[_,N]=(0,l.useState)({}),[S,A]=(0,l.useState)([]);(0,l.useEffect)((()=>{const t=localStorage.getItem("token");if(null==t||void 0==t||""==t)e("/login");else{var l;const e=JSON.parse(localStorage.getItem("user")),t=(null===e||void 0===e||null===(l=e.master_permission)||void 0===l?void 0:l[0])||{};s(t),w(),D(),k()}}),[]);const D=()=>{fetch("https://insuranceapi-3o5t.onrender.com/api/get_location",{method:"GET",headers:{"Content-Type":"application/json"}}).then((e=>e.json())).then((e=>{const t=e.data,s=t.length,l=[];for(let a=0;a<s;a++){const e={label:t[a].location_name,value:t[a]._id};l.push(e)}b(l)}))},w=async()=>{fetch("https://insuranceapi-3o5t.onrender.com/api/getPreferredDays?type=admin",{method:"GET",headers:{"Content-Type":"application/json"}}).then((e=>e.json())).then((e=>{200==e.status&&(console.log(e.data,"data"),g(e.data))}))},E=async(e,t)=>{const s={status:t};m.A.put(`https://insuranceapi-3o5t.onrender.com/api/updatePreferredDay?id=${e}`,s).then((e=>{var s;201==e.status?(h(!1),0==t?d()({text:"Preferred Day Deactivated Successfully",type:"success",icon:"success",buttons:!1}):d()({text:"Preferred Day Activated Successfully",type:"success",icon:"success",buttons:!1}),w(),setTimeout((()=>{d().close()}),1e3)):(h(!1),d()({title:"Error!",text:null===(s=e.data)||void 0===s?void 0:s.message,type:"error",icon:"error"}).then((function(){w()})))}))},k=()=>{const e=[];for(let t=0;t<=24;t++)for(let s=0;s<60;s+=15){const l=t.toString().padStart(2,"0"),a=s.toString().padStart(2,"0"),i=`${l}:${a}`;60!=a&&e.push({value:i,label:i})}for(let t=0;t<4;t++)e.pop();e.push({value:"00:00",label:"00:00"}),A(e)};return(0,u.jsxs)(u.Fragment,{children:[(0,u.jsx)(a.A,{children:(0,u.jsxs)("div",{className:"card mb-4",children:[(0,u.jsx)("div",{className:"card-header",children:(0,u.jsx)("div",{className:"row",children:(0,u.jsx)("div",{className:"col-md-6",children:(0,u.jsx)("h4",{className:"card-title",children:"Preferred Days"})})})}),(0,u.jsx)("div",{className:"card-body",children:(0,u.jsxs)("table",{className:"table table-bordered table-responsive ",children:[(0,u.jsx)("thead",{className:"thead-dark",children:(0,u.jsxs)("tr",{className:"table-info",children:[(0,u.jsx)("th",{scope:"col",children:"#"}),(0,u.jsx)("th",{scope:"col",children:"Name"}),(0,u.jsx)("th",{scope:"col",children:"Start Time"}),(0,u.jsx)("th",{scope:"col",children:"End Time"}),(0,u.jsx)("th",{scope:"col",children:"Location"}),(0,u.jsx)("th",{scope:"col",children:"Action"})]})}),(0,u.jsx)("tbody",{children:(null===y||void 0===y?void 0:y.length)>0?y.map(((e,s)=>{var l,a,i,o;return(0,u.jsxs)("tr",{children:[(0,u.jsx)("td",{children:s+1}),(0,u.jsx)("td",{children:null===e||void 0===e?void 0:e.name}),(0,u.jsx)("td",{children:null===e||void 0===e?void 0:e.start_time}),(0,u.jsx)("td",{children:null===e||void 0===e?void 0:e.end_time}),(0,u.jsx)("td",{children:null===e||void 0===e||null===(l=e.location)||void 0===l||null===(a=l.map((e=>e.location_name)))||void 0===a?void 0:a.join(", ")}),(0,u.jsxs)("td",{children:[(null===(i=t.preferred_days)||void 0===i?void 0:i.includes("edit"))&&(0,u.jsx)("button",{className:"btn btn-primary",onClick:()=>(async e=>{m.A.get(`https://insuranceapi-3o5t.onrender.com/api/getPreferredDaysById?id=${e}`).then((e=>{if(200==e.status){var t;console.log(e.data,"data");const a=null===(t=e.data)||void 0===t?void 0:t.data[0],i=null===a||void 0===a?void 0:a.location;let o=[];for(let e=0;e<(null===i||void 0===i?void 0:i.length);e++){var s,l;const t={label:null===(s=i[e])||void 0===s?void 0:s.location_name,value:null===(l=i[e])||void 0===l?void 0:l._id};o.push(t)}j(o),N(a),p(!0)}else{var a;d()({title:"Error!",text:null===(a=e.data)||void 0===a?void 0:a.message,type:"error",icon:"error"}).then((function(){w()}))}}))})(e._id),children:"Edit"})," ",(null===(o=t.preferred_days)||void 0===o?void 0:o.includes("edit"))&&(0,u.jsx)(u.Fragment,{children:1==e.status?(0,u.jsx)("button",{className:"btn btn-danger mx-1",onClick:()=>{window.confirm("Are you sure you wish to deactivate this item?")&&E(e._id,0)},children:"Deactivate"}):(0,u.jsx)("button",{className:"btn btn-success mx-1",onClick:()=>{window.confirm("Are you sure you wish to activate this item?")&&E(e._id,1)},children:"Activate"})})]})]},s)})):(0,u.jsx)("tr",{children:(0,u.jsx)("td",{colSpan:"6",children:"No Data Found"})})})]})})]})}),(0,u.jsxs)(i.A,{size:"lg",show:v,onHide:()=>p(!1),children:[(0,u.jsx)(i.A.Header,{closeButton:!0,children:(0,u.jsx)(i.A.Title,{children:"Edit Preferred Day"})}),(0,u.jsx)(i.A.Body,{children:(0,u.jsx)("div",{className:"container",children:(0,u.jsx)("div",{className:"row",children:(0,u.jsx)("div",{className:"col-md-12",children:(0,u.jsx)("div",{className:"card",children:(0,u.jsx)("div",{className:"card-body",children:(0,u.jsxs)("form",{method:"PUT",onSubmit:e=>{try{e.preventDefault();const t=new FormData(e.target),s=t.get("name"),l=t.get("start_time"),a=t.get("end_time");if(console.log(l,":",a,"start_time, end_time"),l>=a)return d()({title:"Error!",text:"Start time should be less than End time",type:"error",icon:"error"}),!1;const i={name:s,start_time:l,end_time:a,location:x};m.A.put(`https://insuranceapi-3o5t.onrender.com/api/updatePreferredDay?id=${null===_||void 0===_?void 0:_._id}`,i).then((e=>{var t;201==e.status?(p(!1),d()({text:e.data.message,type:"success",icon:"success",buttons:!1}),w(),setTimeout((()=>{d().close()}),1e3)):d()({title:"Error!",text:null===(t=e.data)||void 0===t?void 0:t.message,type:"error",icon:"error"}).then((function(){w()}))}))}catch(t){console.log(t)}},children:[(0,u.jsxs)("div",{className:"row",children:[(0,u.jsx)("div",{className:"col-md-4",children:(0,u.jsxs)("div",{className:"form-group mb-3",children:[(0,u.jsx)("label",{className:"form-label",children:(0,u.jsx)("strong",{children:"Day"})}),(0,u.jsx)("input",{type:"text",className:"form-control",name:"name",placeholder:"Enter Best plan price Description",defaultValue:null===_||void 0===_?void 0:_.name,autoComplete:"off",required:!0})]})}),(0,u.jsx)("div",{className:"col-md-4",children:(0,u.jsxs)("div",{className:"form-group mb-3",children:[(0,u.jsx)("label",{className:"form-label",children:(0,u.jsx)("strong",{children:"Start Time"})}),(0,u.jsx)("select",{id:"form11",className:"form-control",name:"start_time",required:!0,children:null===S||void 0===S?void 0:S.map(((e,t)=>(0,u.jsx)("option",{selected:(null===_||void 0===_?void 0:_.start_time)==e.value,value:e.value,children:e.label},t)))})]})}),(0,u.jsx)("div",{className:"col-md-4",children:(0,u.jsxs)("div",{className:"form-group mb-3",children:[(0,u.jsx)("label",{className:"form-label",children:(0,u.jsx)("strong",{children:"End Time"})}),(0,u.jsx)("select",{id:"form11",className:"form-control",name:"end_time",required:!0,children:null===S||void 0===S?void 0:S.map(((e,t)=>(0,u.jsx)("option",{selected:(null===_||void 0===_?void 0:_.end_time)==e.value,value:e.value,children:e.label},t)))})]})}),(0,u.jsx)("div",{className:"col-md-4",children:(0,u.jsxs)("div",{className:"form-group mb-3",children:[(0,u.jsx)("label",{children:"Location"}),(0,u.jsx)(c.default,{options:f,selectedValues:x,onSelect:e=>j(e),onRemove:e=>j(e),displayValue:"label",placeholder:"Select Location",closeOnSelect:!1,avoidHighlightFirstOption:!0,showCheckbox:!0,style:{chips:{background:"#007bff"}},required:!0})]})})]}),(0,u.jsx)("div",{children:(0,u.jsx)("button",{className:"btn btn-primary my-2 mx-2",type:"submit",children:"Update"})})]})})})})})})}),(0,u.jsx)(i.A.Footer,{children:(0,u.jsx)(o.A,{variant:"secondary",onClick:()=>p(!1),children:"Close"})})]})]})}}}]);
//# sourceMappingURL=267.13747670.chunk.js.map