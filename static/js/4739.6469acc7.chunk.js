"use strict";(self.webpackChunk_coreui_coreui_free_react_admin_template=self.webpackChunk_coreui_coreui_free_react_admin_template||[]).push([[4739],{96830:(e,a,s)=>{s.r(a),s.d(a,{default:()=>v});var l=s(65043),t=s(73216),n=s(84217),i=s(14282),o=s(54168);const r=s.p+"static/media/Additional-Cover.f62b883670b2349ca56a.xlsx";var c=s(93946),d=s(72450),h=s(11238),m=s(92157),u=s.n(m),p=s(73023),x=s.n(p),j=s(70579);const v=()=>{var e,a,s,m;const p=(0,t.Zp)(),[v]=(0,l.useState)(10),[b,g]=(0,l.useState)(0),[_,f]=(0,l.useState)(1),[N,y]=(0,l.useState)([]),[S,C]=(0,l.useState)([]),[w,k]=(0,l.useState)([]),[A,L]=(0,l.useState)([]),[T,D]=(0,l.useState)(),[E,O]=(0,l.useState)(),[V,P]=(0,l.useState)(),[B,q]=(0,l.useState)(),[F,R]=(0,l.useState)([]),[W,H]=(0,l.useState)(!1),[I,U]=(0,l.useState)(!1),[$,J]=(0,l.useState)(!1),[z,M]=(0,l.useState)(""),[G,Q]=(0,l.useState)([]),[Z,K]=(0,l.useState)([]),[X,Y]=(0,l.useState)([]),[ee,ae]=(0,l.useState)([]),[se,le]=(0,l.useState)(""),[te,ne]=(0,l.useState)(""),[ie,oe]=(0,l.useState)(2);(0,l.useEffect)((()=>{const e=localStorage.getItem("token");if(null===e||void 0===e||""===e)p("/login");else{var a;re(_,v),de(),ce();const e=JSON.parse(localStorage.getItem("user")),s=(null===e||void 0===e||null===(a=e.master_permission)||void 0===a?void 0:a[0])||{};Q(s)}}),[]),(0,l.useEffect)((()=>{re(_,v)}),[se,te,ie]);const re=async(e,a)=>{L([]);const s={method:"GET",headers:{"Content-Type":"application/json",Authorization:"Bearer "+localStorage.getItem("token")}};await fetch(`https://insuranceapi-3o5t.onrender.com/api/get_additional_covers?page=${e}&limit=${a}&name=${se}&lob=${te}&status=${ie}`,s).then((e=>e.json())).then((e=>{const s=e.total/a,l=Math.ceil(s);g(l);const t=e.data;console.log("additional cover data ",t),L(t)}))},ce=()=>{fetch("https://insuranceapi-3o5t.onrender.com/api/get_location",{method:"GET",headers:{"Content-Type":"application/json"}}).then((e=>e.json())).then((e=>{const a=e.data,s=a.length,l=[];for(let t=0;t<s;t++){const e={label:a[t].location_name,value:a[t]._id};l.push(e)}K(l),he(l)}))},de=()=>{fetch("https://insuranceapi-3o5t.onrender.com/api/get_line_of_business_list",{method:"GET",headers:{"Content-Type":"application/json"}}).then((e=>e.json())).then((e=>{const a=e.data,s=a.length,l=[];for(let t=0;t<s;t++){const e={label:a[t].line_of_business_name,value:a[t]._id};l.push(e)}y(l),me(l)}))},he=e=>{k(e)},me=e=>{C(e)},ue=e=>{R(e)},pe=e=>{ae(e)},xe=async(e,a)=>{let s=await fetch("https://insuranceapi-3o5t.onrender.com/api/update_additional_cover_status",{method:"post",body:JSON.stringify({ParamValue:e,additional_cover_status:a}),headers:{"Content-Type":"application/json"}});s=await s.json(),x()("Updated Succesfully","","success"),re(_,v)},je=(_-1)*v;return(0,j.jsxs)("div",{className:"container",children:[(0,j.jsx)("div",{className:"row",children:(0,j.jsx)("div",{className:"col-md-12",children:(0,j.jsxs)("div",{className:"card ",children:[(0,j.jsx)("div",{className:"card-header",children:(0,j.jsxs)("div",{className:"row",children:[(0,j.jsx)("div",{className:"col-md-6",children:(0,j.jsx)("h4",{className:"card-title",children:"Additional Covers"})}),(0,j.jsx)("div",{className:"col-md-6",children:null!==(e=G.additional_cover)&&void 0!==e&&e.includes("create")?(0,j.jsx)("button",{className:"btn btn-primary",style:{float:"right"},onClick:()=>U(!0),children:"Add Additional Cover"}):""})]})}),(0,j.jsxs)("div",{className:"card-header",style:{textAlign:"right"},children:[null!==(a=G.additional_cover)&&void 0!==a&&a.includes("download")?(0,j.jsxs)("a",{className:"btn btn-dark btn-sm btn-icon-text m-r-10",style:{backgroundColor:"green",marginRight:"15px"},href:r,download:!0,children:[(0,j.jsx)("i",{className:"fa fa-cloud-download","aria-hidden":"true"})," Download Sample File"]}):"",null!==(s=G.additional_cover)&&void 0!==s&&s.includes("upload")?(0,j.jsxs)("button",{className:"btn btn-dark btn-sm btn-icon-text m-r-10",style:{backgroundColor:"green",marginRight:"15px"},onClick:()=>H(!W),children:[(0,j.jsx)("i",{className:"fa fa-file-excel","aria-hidden":"true"})," Upload Excel"]}):"",null!==(m=G.additional_cover)&&void 0!==m&&m.includes("export")?(0,j.jsxs)("button",{className:"btn btn-dark btn-sm btn-icon-text m-r-10",style:{backgroundColor:"green"},onClick:()=>{const e={Sheets:{data:h.Wp.json_to_sheet(A)},SheetNames:["data"]},a=h.M9(e,{booktype:"xlsx",type:"array"}),s=new Blob([a],{type:"xlsx"});d.saveAs(s,"Additional-Cover.xlsx")},children:[(0,j.jsx)("i",{className:"fa fa-file-excel","aria-hidden":"true"})," Export Data to excel"]}):""]}),(0,j.jsxs)("div",{className:"row card-header",style:{marginLeft:"10px",marginRight:"10px",alignItems:"center",paddingTop:"5px",paddingBottom:"5px"},children:[(0,j.jsxs)("div",{className:"col-lg-3",children:[(0,j.jsx)("label",{children:(0,j.jsx)("strong",{children:"Search"})}),(0,j.jsx)("br",{}),(0,j.jsx)("input",{type:"text",className:"form-control",placeholder:"Search",onChange:e=>le(e.target.value)})]}),(0,j.jsxs)("div",{className:"col-lg-3",children:[(0,j.jsx)("label",{children:(0,j.jsx)("strong",{children:"Select LOB"})}),(0,j.jsx)("br",{}),(0,j.jsxs)("select",{className:"form-control",value:te,onChange:e=>ne(e.target.value),children:[(0,j.jsx)("option",{hidden:!0,children:"Select LOB"}),(0,j.jsx)("option",{value:"",children:"-- All --"}),N.map(((e,a)=>(0,j.jsx)("option",{value:e.value,children:e.label},a)))]})]}),(0,j.jsxs)("div",{className:"col-lg-3",children:[(0,j.jsx)("label",{children:(0,j.jsx)("strong",{children:"Status"})}),(0,j.jsx)("br",{}),(0,j.jsxs)("select",{className:"form-control",value:ie,onChange:e=>oe(e.target.value),children:[(0,j.jsx)("option",{value:2,children:"-- All --"}),(0,j.jsx)("option",{value:1,children:"Active"}),(0,j.jsx)("option",{value:0,children:"Inactive"})]})]})]}),(0,j.jsxs)("div",{className:"card-body",style:{overflow:"scroll"},children:[(0,j.jsxs)("table",{className:"table table-bordered",children:[(0,j.jsx)("thead",{children:(0,j.jsxs)("tr",{children:[(0,j.jsx)("th",{children:(0,j.jsx)("strong",{children:"#"})}),(0,j.jsx)("th",{children:(0,j.jsx)("strong",{children:"Cover"})}),(0,j.jsx)("th",{children:(0,j.jsx)("strong",{children:"Description"})}),(0,j.jsx)("th",{children:(0,j.jsx)("strong",{children:"Location"})}),(0,j.jsx)("th",{children:(0,j.jsx)("strong",{children:"Line Of Business"})}),(0,j.jsx)("th",{children:(0,j.jsx)("strong",{children:"Status"})})]})}),(0,j.jsx)("tbody",{children:A.length>0?A.map(((e,a)=>{var s,l,t,n,i;return(0,j.jsxs)("tr",{children:[(0,j.jsx)("td",{children:je+a+1}),(0,j.jsx)("td",{children:e.additional_cover_label}),(0,j.jsx)("td",{children:e.additional_cover_description}),(0,j.jsx)("td",{children:null===(s=e.locations)||void 0===s?void 0:s.map((e=>e.location_name)).join(", ")}),(0,j.jsx)("td",{children:null===(l=e.lob_result)||void 0===l?void 0:l.map((e=>e.line_of_business_name)).join(", ")}),(0,j.jsxs)("td",{children:[(null===(t=G.additional_cover)||void 0===t?void 0:t.includes("edit"))&&(0,j.jsx)("button",{className:"btn btn-primary",onClick:()=>(async e=>{q(e);const a={method:"post",body:JSON.stringify({ParamValue:e}),headers:{"Content-Type":"application/json"}};let s=await fetch("https://insuranceapi-3o5t.onrender.com/api/get_additional_coverbyid",a);s=await s.json(),console.log(s.data,"<<<<<<<<<"),D(s.data[0].additional_cover_label),O(s.data[0].additional_cover_description),P(s.data[0].additional_cover_status);const l=s.data[0].lob_result,t=s.data[0].locations,n=[],i=[];for(let o=0;o<l.length;o++){const e={label:l[o].line_of_business_name,value:l[o]._id};n.push(e)}for(let o=0;o<t.length;o++){const e={label:t[o].location_name,value:t[o]._id};i.push(e)}Y(i),R(n),ae(i),J(!0)})(e._id),children:"Edit"})," ",(null===(n=G.additional_cover)||void 0===n?void 0:n.includes("delete"))&&(0,j.jsx)(j.Fragment,{children:1===e.additional_cover_status?(0,j.jsx)("button",{className:"btn btn-danger mr-5",onClick:()=>{window.confirm("Are you sure you wish to deactivate this item?")&&xe(e._id,0)},children:"Deactivate"}):(0,j.jsx)("button",{className:"btn btn-success mr-5",onClick:()=>{window.confirm("Are you sure you wish to activate this item?")&&xe(e._id,1)},children:"Activate"})})," ",(null===(i=G.additional_cover)||void 0===i?void 0:i.includes("delete"))&&(0,j.jsx)("button",{className:"btn btn-warning mr-5",onClick:()=>{window.confirm("Are you sure you wish to delete this item?")&&(async e=>{await fetch(`https://insuranceapi-3o5t.onrender.com/api/deleteMotorMaster/?id=${e}&type=additionalCover`,{method:"DELETE",headers:{"Content-Type":"application/json"}}).then((e=>e.json())).then((e=>{200===e.status?(x()({text:e.message,type:"success",icon:"success",button:!1}),re(_,v),setTimeout((()=>{x().close()}),1e3)):x()("Something Went Wrong","","error"),re(_,v)}))})(e._id)},children:"Delete"})]})]},a)})):(0,j.jsx)("tr",{children:(0,j.jsx)("td",{colSpan:"6",children:"No Data Found"})})})]}),(0,j.jsx)(u(),{previousLabel:"Previous",nextLabel:"Next",breakLabel:"...",pageCount:b,marginPagesDisplayed:2,pageRangeDisplayed:3,onPageChange:e=>{const a=e.selected;f(a+1),re(a+1,v)},containerClassName:"pagination justify-content-end",pageClassName:"page-item",pageLinkClassName:"page-link",previousClassName:"page-item",previousLinkClassName:"page-link",nextClassName:"page-item",nextLinkClassName:"page-link",breakClassName:"page-item",breakLinkClassName:"page-link",activeClassName:"active"})]})]})})}),(0,j.jsxs)(c.zS,{alignment:"center",visible:W,onClose:()=>H(!1),children:[(0,j.jsx)(c.E4,{onClose:()=>H(!1),children:(0,j.jsx)(c.lb,{children:"Upload Excel File"})}),(0,j.jsx)(c.Tc,{children:(0,j.jsx)("div",{children:(0,j.jsx)("input",{type:"file",className:"form-control",id:"DHA",defaultValue:"",required:!0,onChange:e=>M(e.target.files[0])})})}),(0,j.jsxs)(c.If,{children:[(0,j.jsx)(c.Q_,{color:"secondary",onClick:()=>H(!1),children:"Close"}),(0,j.jsx)(c.Q_,{color:"primary",onClick:async e=>{e.preventDefault();const a=new FormData;a.append("file",z);let s=await fetch("https://insuranceapi-3o5t.onrender.com/api/read_additional_cover_excel ",{method:"post",body:a});s=await s.json(),H(!W),x()("Uploaded Succesfully","","success"),re(_,v)},href:"/Viewtraveltype",children:"Upload"})]})]}),(0,j.jsxs)(n.A,{size:"lg",show:I,onHide:()=>U(!1),children:[(0,j.jsx)(n.A.Header,{closeButton:!0,children:(0,j.jsx)(n.A.Title,{children:"Add Additional Cover"})}),(0,j.jsx)(n.A.Body,{children:(0,j.jsx)("div",{className:"container",children:(0,j.jsx)("div",{className:"row",children:(0,j.jsx)("div",{className:"col-md-12",children:(0,j.jsx)("div",{className:"card",children:(0,j.jsx)("div",{className:"card-body",children:(0,j.jsxs)("form",{action:"/",method:"POST",onSubmit:async e=>{e.preventDefault();const a=e.target.additional_cover_label.value,s=e.target.additional_cover_description.value,l=S.map((e=>{let{value:a}=e;return a})),t=w.map((e=>{let{value:a}=e;return a}));if(console.log(l,"<<<<<<lob"),0===l.length)return x()("Please Select lob","","error"),!1;if(0===t.length)return x()("Please Select location","","error"),!1;const n={method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({additional_cover_label:a,additional_cover_description:s,additional_cover_lob:l,additional_cover_location:t})};await fetch("https://insuranceapi-3o5t.onrender.com/api/add_additional_cover",n).then((e=>e.json())).then((e=>{200===e.status?(U(!1),x()({text:e.message,type:"success",icon:"success",button:!1}),re(_,v),setTimeout((()=>{x().close()}),1e3)):x()("Something Went Wrong","","error")}))},children:[(0,j.jsxs)("div",{className:"row",children:[(0,j.jsx)("div",{className:"col-md-6",children:(0,j.jsxs)("div",{className:"form-group mb-3",children:[(0,j.jsx)("label",{className:"form-label",children:(0,j.jsx)("strong",{children:"Additional Cover Label"})}),(0,j.jsx)("input",{type:"text",className:"form-control",name:"additional_cover_label",placeholder:"Enter Additional Cover Label",defaultValue:"",required:!0})]})}),(0,j.jsx)("div",{className:"col-md-6",children:(0,j.jsxs)("div",{className:"form-group mb-3",children:[(0,j.jsx)("label",{className:"form-label",children:(0,j.jsx)("strong",{children:"Additional Cover Description"})}),(0,j.jsx)("input",{type:"text",className:"form-control",name:"additional_cover_description",placeholder:"Enter Additional Cover Description",defaultValue:"",required:!0})]})}),(0,j.jsx)("div",{className:"col-md-6",children:(0,j.jsxs)("div",{className:"form-group mb-3",children:[(0,j.jsx)("label",{className:"form-label",children:(0,j.jsx)("strong",{children:"Locations"})}),(0,j.jsx)(o.default,{options:Z,selectedValues:Z,displayValue:"label",onSelect:k,onRemove:k,placeholder:"Select Location",showArrow:!0,showCheckbox:!0,required:!0})]})}),(0,j.jsx)("div",{className:"col-md-6",children:(0,j.jsxs)("div",{className:"form-group mb-3",children:[(0,j.jsx)("label",{className:"form-label",children:(0,j.jsx)("strong",{children:"Line Of Business"})}),(0,j.jsx)(o.default,{options:N,selectedValues:N,displayValue:"label",onSelect:C,onRemove:C,placeholder:"Select Line Of Business",showCheckbox:!0,required:!0})]})})]}),(0,j.jsx)("div",{className:"row",children:(0,j.jsx)("div",{className:"col-md-12",children:(0,j.jsx)("button",{type:"submit",className:"btn btn-primary mt-2 submit_all",style:{float:"right"},children:"Submit"})})})]})})})})})})}),(0,j.jsx)(n.A.Footer,{children:(0,j.jsx)(i.A,{variant:"secondary",onClick:()=>U(!1),children:"Close"})})]}),(0,j.jsxs)(n.A,{size:"lg",show:$,onHide:()=>J(!1),children:[(0,j.jsx)(n.A.Header,{closeButton:!0,children:(0,j.jsx)(n.A.Title,{children:"Edit Additional Cover"})}),(0,j.jsx)(n.A.Body,{children:(0,j.jsx)("div",{className:"container",children:(0,j.jsx)("div",{className:"row",children:(0,j.jsx)("div",{className:"col-md-12",children:(0,j.jsx)("div",{className:"card",children:(0,j.jsx)("div",{className:"card-body",children:(0,j.jsxs)("form",{action:"/",method:"POST",onSubmit:async(e,a)=>{e.preventDefault();const s=B;console.log(F,">>>>>>>>>>>>>");const l=e.target.additional_cover_label.value,t=e.target.additional_cover_description.value,n=F.map((e=>e.value)),i=ee.map((e=>e.value));if(0===n.length)return x()("Please Select Location","","error"),!1;const o={method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({ParamValue:s,additional_cover_label:l,additional_cover_description:t,additional_cover_lob:n,additional_cover_loc:i})};await fetch("https://insuranceapi-3o5t.onrender.com/api/update_additional_cover",o).then((e=>e.json())).then((e=>{200===e.status?(x()({text:e.message,type:"success",icon:"success",button:!1}),J(!1),re(_,v),setTimeout((()=>{x().close()}),1e3)):x()("Something Went Wrong","","error")}))},children:[(0,j.jsxs)("div",{className:"row",children:[(0,j.jsxs)("div",{className:"col-md-6",children:[(0,j.jsx)("label",{className:"form-label",children:(0,j.jsx)("strong",{children:"Additional Cover Label"})}),(0,j.jsx)("input",{type:"text",className:"form-control mb-3",name:"additional_cover_label",placeholder:"Name",defaultValue:T,required:!0})]}),(0,j.jsxs)("div",{className:"col-md-6",children:[(0,j.jsx)("label",{className:"form-label",children:(0,j.jsx)("strong",{children:"Edit Additional Cover Description"})}),(0,j.jsx)("input",{type:"text",className:"form-control mb-3",name:"additional_cover_description",placeholder:"Description",defaultValue:E,required:!0})]}),(0,j.jsxs)("div",{className:"col-md-6",children:[(0,j.jsx)("label",{className:"form-label",children:(0,j.jsx)("strong",{children:"Select Line Of business"})}),(0,j.jsx)(o.default,{options:N,selectedValues:F,onSelect:ue,onRemove:ue,displayValue:"label",placeholder:"Select Location",closeOnSelect:!1,avoidHighlightFirstOption:!0,showCheckbox:!0,style:{chips:{background:"#007bff"}},required:!0})]}),(0,j.jsx)("div",{className:"col-md-6",children:(0,j.jsxs)("div",{className:"form-group mb-3",children:[(0,j.jsx)("label",{className:"form-label",children:(0,j.jsx)("strong",{children:"Locations"})}),(0,j.jsx)(o.default,{options:Z,selectedValues:X,displayValue:"label",onSelect:pe,onRemove:pe,placeholder:"Select Location",showArrow:!0,showCheckbox:!0,required:!0})]})})]}),(0,j.jsx)("div",{className:"row",children:(0,j.jsx)("div",{className:"col-md-12",children:(0,j.jsx)("button",{type:"submit",className:"btn btn-primary mt-2 submit_all",style:{float:"right"},children:"Update"})})})]})})})})})})}),(0,j.jsx)(n.A.Footer,{children:(0,j.jsx)(i.A,{variant:"secondary",onClick:()=>J(!1),children:"Close"})})]})]})}}}]);
//# sourceMappingURL=4739.6469acc7.chunk.js.map