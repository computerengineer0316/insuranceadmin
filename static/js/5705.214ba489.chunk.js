(self.webpackChunk_coreui_coreui_free_react_admin_template=self.webpackChunk_coreui_coreui_free_react_admin_template||[]).push([[5705],{95705:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>p});var n=s(65043),a=s(53519),o=s(84217),i=s(14282),l=s(73216),c=s(92157),r=s.n(c),d=(s(38442),s(93946),s(72450),s(73023)),u=s.n(d),m=s(54168),h=s(70579);const p=()=>{var e;const t=(0,l.Zp)(),[s,c]=(0,n.useState)([]),[d]=(0,n.useState)(10),[p,v]=(0,n.useState)(0),[f,j]=(0,n.useState)(1),[x,b]=(0,n.useState)([]),[g,y]=(0,n.useState)(null),[_,N]=(0,n.useState)(""),[w,S]=(0,n.useState)(""),[k,T]=(0,n.useState)(!1),[C,A]=(0,n.useState)(!1),[L,E]=(0,n.useState)([]),[O,B]=(0,n.useState)([]),[R,V]=(0,n.useState)("");(0,n.useEffect)((()=>{const e=localStorage.getItem("token");if(null===e||void 0===e||""===e)t("/login");else{var s;D(f,d),M(),H();const e=JSON.parse(localStorage.getItem("user")),t=(null===e||void 0===e||null===(s=e.master_permission)||void 0===s?void 0:s[0])||{};console.log(t,"master_permission"),E(t)}}),[]);const D=async(e,t)=>{c([]);const s={method:"GET",headers:{"Content-Type":"application/json",Authorization:"Bearer "+localStorage.getItem("token")}};fetch(`https://insuranceapi-3o5t.onrender.com/api/get_vat?page=${e}&limit=${t}`,s).then((e=>e.json())).then((e=>{const s=e.total/t,n=Math.ceil(s);v(n);const a=e.data;console.log(e.data,">>>>>>>>>>>>> list"),c(a)}))},P=async(e,t)=>{let s=await fetch("https://insuranceapi-3o5t.onrender.com/api/update_vat_status",{method:"post",body:JSON.stringify({id:e,vat_status:t}),headers:{"Content-Type":"application/json"}});s=await s.json(),u()({text:s.message,type:"success",icon:"success",button:!1}),D(f,d),setTimeout((()=>{u().close()}),1e3)},M=()=>{fetch("https://insuranceapi-3o5t.onrender.com/api/get_location",{method:"GET",headers:{"Content-Type":"application/json"}}).then((e=>e.json())).then((e=>{const t=e.data;b(t),F(t)}))},F=e=>{y(e)},H=()=>{fetch("https://insuranceapi-3o5t.onrender.com/api/get_line_of_business_list",{method:"GET",headers:{"Content-Type":"application/json"}}).then((e=>e.json())).then((e=>{const t=e.data;console.log(t,">>>>>>>>>>>>>>> lobs"),B(t)}))},U=(f-1)*d;return(0,h.jsxs)(h.Fragment,{children:[(0,h.jsx)(a.A,{children:(0,h.jsxs)("div",{className:"card mb-4",children:[(0,h.jsx)("div",{className:"card-header",children:(0,h.jsxs)("div",{className:"row",children:[(0,h.jsx)("div",{className:"col-md-6",children:(0,h.jsx)("h4",{className:"card-title",children:"Vat"})}),(0,h.jsx)("div",{className:"col-md-6",children:null!==(e=L.vat)&&void 0!==e&&e.includes("create")?(0,h.jsx)("button",{className:"btn btn-primary",style:{float:"right"},onClick:()=>T(!0),children:"Add Vat"}):""})]})}),(0,h.jsxs)("div",{className:"card-body",children:[(0,h.jsxs)("table",{className:"table table-bordered",children:[(0,h.jsx)("thead",{className:"thead-dark",children:(0,h.jsxs)("tr",{className:"table-info",children:[(0,h.jsx)("th",{scope:"col",children:"#"}),(0,h.jsx)("th",{scope:"col",children:"Percentage"}),(0,h.jsx)("th",{scope:"col",children:"Line Of Business"}),(0,h.jsx)("th",{scope:"col",children:"Location"}),(0,h.jsx)("th",{scope:"col",children:"Action"})]})}),(0,h.jsx)("tbody",{children:(null===s||void 0===s?void 0:s.length)>0?s.map(((e,t)=>{var s,n,a;return(0,h.jsxs)("tr",{children:[(0,h.jsx)("td",{children:U+t+1}),(0,h.jsx)("td",{children:e.vat_percentage}),(0,h.jsx)("td",{children:e.vat_lobs.map((e=>e.line_of_business_name)).join(", ")}),(0,h.jsx)("td",{children:null===(s=e.locations)||void 0===s?void 0:s.map((e=>e.location_name)).join(", ")}),(0,h.jsxs)("td",{children:[(null===(n=L.vat)||void 0===n?void 0:n.includes("edit"))&&(0,h.jsx)("button",{className:"btn btn-primary",onClick:()=>(async e=>{var t,s,n;S(e);const a={method:"POST",body:JSON.stringify({ParamValue:e}),headers:{"Content-Type":"application/json"}};let o=await fetch("https://insuranceapi-3o5t.onrender.com/api/get_vat_detailsbyid",a);o=await o.json(),N(null===(t=o.data[0])||void 0===t?void 0:t.vat_percentage);const i=null===(s=o.data[0])||void 0===s?void 0:s.vat_location,l=null===(n=o.data[0])||void 0===n?void 0:n.vat_lob;console.log(o.data[0],">>>>>>>>>>>>>>>>>>>>>>>>>> asdfsafsf"),y(i),A(!0),V(l)})(e._id),children:"Edit"})," ",null!==(a=L.vat)&&void 0!==a&&a.includes("delete")?(0,h.jsxs)(h.Fragment,{children:[1==e.vat_status?(0,h.jsx)("button",{className:"btn btn-danger",onClick:()=>{window.confirm("Are you sure you wish to deactivate this item?")&&P(e._id,0)},children:"Deactivate"}):(0,h.jsx)("button",{className:"btn btn-success",onClick:()=>{window.confirm("Are you sure you wish to activate this item?")&&P(e._id,1)},children:"Activate"}),(0,h.jsx)("button",{className:"btn btn-warning mx-1",onClick:()=>{var t;window.confirm("Are you sure you wish to delete this item?")&&(t=e._id,fetch(`https://insuranceapi-3o5t.onrender.com/api/deleteMotorMaster/?id=${t}&type=vat`,{method:"DELETE",headers:{"Content-Type":"application/json"}}).then((e=>e.json())).then((e=>{200===e.status?(u()({title:"Success!",text:e.message,icon:"success",button:!1}),D(f,d),setTimeout((()=>{u().close()}),1e3)):(u()({title:"Error!",text:e.message,icon:"error",button:!1}),D(f,d),setTimeout((()=>{u().close()}),1e3))})))},children:"Delete"})]}):""]})]},t)})):(0,h.jsx)("tr",{children:(0,h.jsx)("td",{colSpan:"6",children:"No Data Found"})})})]}),(0,h.jsx)(r(),{previousLabel:"Previous",nextLabel:"Next",breakLabel:"...",pageCount:p,marginPagesDisplayed:2,pageRangeDisplayed:3,onPageChange:e=>{const t=e.selected;j(t+1),D(t+1,d)},containerClassName:"pagination justify-content-end",pageClassName:"page-item",pageLinkClassName:"page-link",previousClassName:"page-item",previousLinkClassName:"page-link",nextClassName:"page-item",nextLinkClassName:"page-link",breakClassName:"page-item",breakLinkClassName:"page-link",activeClassName:"active"})]})]})}),(0,h.jsxs)(o.A,{size:"lg",show:k,onHide:()=>T(!1),children:[(0,h.jsx)(o.A.Header,{closeButton:!0,children:(0,h.jsx)(o.A.Title,{children:"Add Vat"})}),(0,h.jsx)(o.A.Body,{children:(0,h.jsx)("div",{className:"container",children:(0,h.jsx)("div",{className:"row",children:(0,h.jsx)("div",{className:"col-md-12",children:(0,h.jsx)("div",{className:"card",children:(0,h.jsx)("div",{className:"card-body",children:(0,h.jsxs)("form",{action:"/",method:"POST",onSubmit:async e=>{e.preventDefault();const t=new FormData(e.target),s=t.get("vat_percentage"),n=t.get("line_of_buisness"),a=g,o=a.length,i=[],l=[];for(let c=0;c<n.length;c++)l.push(n[c]._id);for(let c=0;c<o;c++)i.push(a[c]._id);await fetch("https://insuranceapi-3o5t.onrender.com/api/add_vat",{method:"post",body:JSON.stringify({vat_percentage:s,vat_location:i,vat_lob:n}),headers:{"Content-Type":"application/json"}}).then((e=>e.json())).then((e=>{200==e.status?(T(!1),u()({text:e.message,type:"success",icon:"success",button:!1}),D(f,d),setTimeout((()=>{u().close()}),1e3)):(T(!1),u()({title:"Error!",text:e.message,type:"error",icon:"error",button:!1}),D(f,d),setTimeout((()=>{u().close()}),1e3))}))},children:[(0,h.jsxs)("div",{className:"row",children:[(0,h.jsxs)("div",{className:"col-md-6",children:[(0,h.jsx)("label",{className:"form-label",children:(0,h.jsx)("strong",{children:"Add Vat Percentage"})}),(0,h.jsx)("input",{type:"text",className:"form-control",name:"vat_percentage",placeholder:"Enter Vat Percentage",defaultValue:"",required:!0})]}),(0,h.jsxs)("div",{className:"col-md-6",children:[(0,h.jsx)("label",{className:"form-label",children:(0,h.jsx)("strong",{children:"Select Location"})}),(0,h.jsx)(m.default,{options:x,selectedValues:x,displayValue:"location_name",onSelect:y,onRemove:y,placeholder:"Select Location",showCheckbox:!0,required:!0})]}),(0,h.jsx)("div",{className:"col-md-6",children:(0,h.jsxs)("div",{className:"form-group mb-3",children:[(0,h.jsx)("label",{children:"Line Of Business"}),(0,h.jsxs)("select",{className:"form-control",name:"line_of_buisness",children:[(0,h.jsx)("option",{value:"",hidden:!0,children:"Select Line Of Buisness"}),O.map(((e,t)=>(0,h.jsx)("option",{value:e._id,children:e.line_of_business_name},t)))]})]})})]}),(0,h.jsx)("div",{className:"row",children:(0,h.jsx)("div",{className:"col-md-12",children:(0,h.jsx)("button",{type:"submit",className:"btn btn-primary mt-2 submit_all",style:{float:"right"},children:"Submit"})})})]})})})})})})}),(0,h.jsx)(o.A.Footer,{children:(0,h.jsx)(i.A,{variant:"secondary",onClick:()=>T(!1),children:"Close"})})]}),(0,h.jsxs)(o.A,{size:"lg",show:C,onHide:()=>A(!1),children:[(0,h.jsx)(o.A.Header,{closeButton:!0,children:(0,h.jsx)(o.A.Title,{children:"Edit Vat"})}),(0,h.jsx)(o.A.Body,{children:(0,h.jsx)("div",{className:"container",children:(0,h.jsx)("div",{className:"row",children:(0,h.jsx)("div",{className:"col-md-12",children:(0,h.jsx)("div",{className:"card",children:(0,h.jsx)("div",{className:"card-body",children:(0,h.jsxs)("form",{action:"/",method:"POST",onSubmit:async e=>{e.preventDefault();const t=new FormData(e.target),s=t.get("vat_percentage"),n=t.get("line_of_buisness"),a=g,o=a.length,i=[],l=[];for(let c=0;c<n.length;c++)l.push(n[c]._id);for(let c=0;c<o;c++)i.push(a[c]._id);await fetch("https://insuranceapi-3o5t.onrender.com/api/update_vat_details",{method:"POST",body:JSON.stringify({ParamValue:w,vat_percentage:s,vat_location:i,vat_lob:n}),headers:{"Content-Type":"application/json"}}).then((e=>e.json())).then((e=>{200==e.status?(A(!1),u()({text:e.message,type:"success",icon:"success",button:!1}),D(f,d),setTimeout((()=>{u().close()}),1e3)):(A(!1),u()({title:"Error!",text:e.message,type:"error",icon:"error",button:!1}),D(f,d),setTimeout((()=>{u().close()}),1e3))}))},children:[(0,h.jsxs)("div",{className:"row",children:[(0,h.jsxs)("div",{className:"col-md-6",children:[(0,h.jsx)("label",{className:"form-label",children:(0,h.jsx)("strong",{children:"Edit Policy Type"})}),(0,h.jsx)("input",{type:"text",className:"form-control",name:"vat_percentage",placeholder:"Name",defaultValue:_,required:!0})]}),(0,h.jsxs)("div",{className:"col-md-6",children:[(0,h.jsx)("label",{className:"form-label",children:(0,h.jsx)("strong",{children:"Select Location"})}),(0,h.jsx)(m.default,{options:x,selectedValues:g,onSelect:F,onRemove:F,displayValue:"location_name",placeholder:"Select Location",closeOnSelect:!1,avoidHighlightFirstOption:!0,showCheckbox:!0,style:{chips:{background:"#007bff"}},required:!0})]}),(0,h.jsx)("div",{className:"col-md-6",children:(0,h.jsxs)("div",{className:"form-group mb-3",children:[(0,h.jsx)("label",{children:"Line Of Business"}),(0,h.jsxs)("select",{className:"form-control",name:"line_of_buisness",children:[(0,h.jsx)("option",{value:"",hidden:!0,children:"Select Line Of Buisness"}),O.map(((e,t)=>(0,h.jsx)("option",{value:e._id,selected:R==e._id,children:e.line_of_business_name},t)))]})]})})]}),(0,h.jsx)("div",{className:"row",children:(0,h.jsx)("div",{className:"col-md-12",children:(0,h.jsx)("button",{type:"submit",className:"btn btn-primary mt-2 submit_all",style:{float:"right"},children:"Submit"})})})]})})})})})})}),(0,h.jsx)(o.A.Footer,{children:(0,h.jsx)(i.A,{variant:"secondary",onClick:()=>A(!1),children:"Close"})})]})]})}},72450:function(e,t,s){var n,a,o;a=[],void 0===(o="function"===typeof(n=function(){"use strict";function t(e,t){return"undefined"==typeof t?t={autoBom:!1}:"object"!=typeof t&&(console.warn("Deprecated: Expected third argument to be a object"),t={autoBom:!t}),t.autoBom&&/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(e.type)?new Blob(["\ufeff",e],{type:e.type}):e}function n(e,t,s){var n=new XMLHttpRequest;n.open("GET",e),n.responseType="blob",n.onload=function(){c(n.response,t,s)},n.onerror=function(){console.error("could not download file")},n.send()}function a(e){var t=new XMLHttpRequest;t.open("HEAD",e,!1);try{t.send()}catch(e){}return 200<=t.status&&299>=t.status}function o(e){try{e.dispatchEvent(new MouseEvent("click"))}catch(n){var t=document.createEvent("MouseEvents");t.initMouseEvent("click",!0,!0,window,0,0,0,80,20,!1,!1,!1,!1,0,null),e.dispatchEvent(t)}}var i="object"==typeof window&&window.window===window?window:"object"==typeof self&&self.self===self?self:"object"==typeof s.g&&s.g.global===s.g?s.g:void 0,l=i.navigator&&/Macintosh/.test(navigator.userAgent)&&/AppleWebKit/.test(navigator.userAgent)&&!/Safari/.test(navigator.userAgent),c=i.saveAs||("object"!=typeof window||window!==i?function(){}:"download"in HTMLAnchorElement.prototype&&!l?function(e,t,s){var l=i.URL||i.webkitURL,c=document.createElement("a");t=t||e.name||"download",c.download=t,c.rel="noopener","string"==typeof e?(c.href=e,c.origin===location.origin?o(c):a(c.href)?n(e,t,s):o(c,c.target="_blank")):(c.href=l.createObjectURL(e),setTimeout((function(){l.revokeObjectURL(c.href)}),4e4),setTimeout((function(){o(c)}),0))}:"msSaveOrOpenBlob"in navigator?function(e,s,i){if(s=s||e.name||"download","string"!=typeof e)navigator.msSaveOrOpenBlob(t(e,i),s);else if(a(e))n(e,s,i);else{var l=document.createElement("a");l.href=e,l.target="_blank",setTimeout((function(){o(l)}))}}:function(e,t,s,a){if((a=a||open("","_blank"))&&(a.document.title=a.document.body.innerText="downloading..."),"string"==typeof e)return n(e,t,s);var o="application/octet-stream"===e.type,c=/constructor/i.test(i.HTMLElement)||i.safari,r=/CriOS\/[\d]+/.test(navigator.userAgent);if((r||o&&c||l)&&"undefined"!=typeof FileReader){var d=new FileReader;d.onloadend=function(){var e=d.result;e=r?e:e.replace(/^data:[^;]*;/,"data:attachment/file;"),a?a.location.href=e:location=e,a=null},d.readAsDataURL(e)}else{var u=i.URL||i.webkitURL,m=u.createObjectURL(e);a?a.location=m:location.href=m,a=null,setTimeout((function(){u.revokeObjectURL(m)}),4e4)}});i.saveAs=c.saveAs=c,e.exports=c})?n.apply(t,a):n)||(e.exports=o)},38442:(e,t,s)=>{"use strict";e.exports=s.p+"static/media/policy-type.7bf5b349f238deec7e96.xlsx"}}]);
//# sourceMappingURL=5705.214ba489.chunk.js.map