"use strict";(self.webpackChunk_coreui_coreui_free_react_admin_template=self.webpackChunk_coreui_coreui_free_react_admin_template||[]).push([[4914],{14914:(e,s,a)=>{a.r(s),a.d(s,{default:()=>r});var t=a(65043),l=a(73216),o=a(30064),n=a.n(o),i=a(54168),c=a(70579);const r=()=>{const e=(0,l.Zp)(),[s,a]=(0,t.useState)(""),[o,r]=(0,t.useState)(""),[d,m]=(0,t.useState)(""),[f,u]=(0,t.useState)(""),[h,p]=(0,t.useState)(""),[v,x]=(0,t.useState)(""),[j,b]=(0,t.useState)([]),[_,g]=(0,t.useState)([]),[N,y]=(0,t.useState)(""),[S,w]=(0,t.useState)(""),[C,T]=(0,t.useState)([]),[E,k]=(0,t.useState)([]),[O,V]=(0,t.useState)(null),[B,q]=(0,t.useState)(""),[P,U]=(0,t.useState)({}),[D,G]=(0,t.useState)([]),[R,A]=(0,t.useState)([]),[F,L]=(0,t.useState)("");(0,t.useEffect)((()=>{const s=localStorage.getItem("token");if(null===s||void 0===s||""===s)e("/login");else{const e=window.location.href.split("/")[3],s=e.split("?")[1].split("=")[1],a=e.split("?")[2].split("=")[1];console.log(s,">>>>>>>>",a),y(s),q(a),M(),"Customer"==a?Z(s):I(s),$(),J();k([{label:"New Business",value:"New Business"},{label:"Renewal Business",value:"Renewal Business"}])}}),[]);const M=()=>{fetch("https://insuranceapi-3o5t.onrender.com/api/getCompany",{method:"GET",headers:{"Content-Type":"application/json"}}).then((e=>e.json())).then((e=>{A(e.data)}))};(0,t.useEffect)((()=>{console.log("i worked toooooooooooooooooooo"),console.log(h,"staff_location"),H()}),[h]);const $=()=>{fetch("https://insuranceapi-3o5t.onrender.com/api/get_location",{method:"GET",headers:{"Content-Type":"application/json"}}).then((e=>e.json())).then((e=>{const s=e.data,a=s.length,t=[];for(let l=0;l<a;l++){const e={label:s[l].location_name,value:s[l]._id};t.push(e)}b(t)}))};console.log(f,"stafflob");const H=()=>{const e=null==h||0==h.length?j.map((e=>e.value)):h.map((e=>e.value)),s=new URLSearchParams;e.forEach((e=>{s.append("location",e)})),fetch(`https://insuranceapi-3o5t.onrender.com/api/get_line_of_business_list?${s.toString()}`,{method:"GET",headers:{"Content-Type":"application/json"}}).then((e=>e.json())).then((e=>{const s=e.data,a=s.length,t=[];for(let l=0;l<a;l++){const e={label:s[l].line_of_business_name,value:s[l]._id};t.push(e)}if(g(t),f.length>0){const e=f.map((e=>e.value)),s=t.filter((s=>e.includes(s.value)));u(s)}}))},J=()=>{fetch("https://insuranceapi-3o5t.onrender.com/api/get_user_type",{method:"GET",headers:{"Content-Type":"application/json"}}).then((e=>e.json())).then((e=>{T(e.data)}))},I=e=>{fetch(`https://insuranceapi-3o5t.onrender.com/api/getStaffDetailsbyid/${e}`,{method:"GET",headers:{"Content-Type":"application/json"}}).then((e=>e.json())).then((e=>{var s,t,l,o,n,i,c;(w(null===(s=e.data[0])||void 0===s?void 0:s.usertype),a(null===(t=e.data[0])||void 0===t?void 0:t.name),r(null===(l=e.data[0])||void 0===l?void 0:l.email),m(null===(o=e.data[0])||void 0===o?void 0:o.mobile),"653604248028cba2487f7d2a"==(null===(n=e.data[0])||void 0===n?void 0:n.usertype))&&(G(!0),L(null===(c=e.data[0])||void 0===c?void 0:c.insurance_company));const d=null===(i=e.data[0])||void 0===i?void 0:i.line_of_business,f=null===d||void 0===d?void 0:d.length,h=[];for(let a=0;a<f;a++){const e={label:d[a].lob_name,value:d[a].lob_id};h.push(e)}u(h);const v=e.data[0].location,j=v.length,b=[];for(let a=0;a<j;a++){const e={label:v[a].loc_name,value:v[a].loc_id};b.push(e)}var _=b;const g=e.data[0].admin_business_type,N=null===g||void 0===g?void 0:g.length,y=[];for(let a=0;a<N;a++){const e={label:g[a].type,value:g[a].type};y.push(e)}var S=y;p(_),x(S)}))},Z=e=>{fetch(`https://insuranceapi-3o5t.onrender.com/api/getCustomerDetails?id=${e}`,{method:"GET",headers:{"Content-Type":"application/json"}}).then((e=>e.json())).then((e=>{U(e.data),console.log(e.data,"<<<<customer details")}))},z=e=>{p(e)},K=e=>{u(e)};return(0,c.jsx)("div",{className:"container",children:(0,c.jsx)("div",{className:"row",children:(0,c.jsx)("div",{className:"col-md-12",children:(0,c.jsx)("div",{className:"card",style:{marginTop:"20px"},children:(0,c.jsx)("div",{className:"card-header",children:(0,c.jsxs)("div",{className:"row",children:[(0,c.jsx)("div",{className:"col-md-6",children:(0,c.jsx)("h4",{className:"card-title",children:"Edit Staff"})}),(0,c.jsx)("div",{className:"col-md-6",children:(0,c.jsx)("a",{href:"/ViewStaff",className:"btn btn-primary",style:{float:"right"},children:"Back"})}),"Customer"==B?(0,c.jsx)("div",{className:"card-body",children:(0,c.jsxs)("form",{action:"/",method:"PUT",onSubmit:s=>{s.preventDefault();const a=new FormData(s.target),t=a.get("staff_name"),l=a.get("staff_email"),o=a.get("staff_mobile"),i={method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({full_name:t,email:l,mobile_number:o})};fetch(`https://insuranceapi-3o5t.onrender.com/api/updateCustomerProfile?id=${N}`,i).then((e=>e.json())).then((s=>{200===s.status?n().fire({title:"Success",text:s.message,icon:"success",confirmButtonText:"Ok"}).then((s=>{s.isConfirmed&&e("/ViewStaff")})):n().fire({title:"Error",text:s.message,icon:"error",confirmButtonText:"Ok"}).then((s=>{s.isConfirmed&&e("/ViewStaff")}))}))},children:[(0,c.jsxs)("div",{className:"row",children:[(0,c.jsx)("div",{className:"col-md-4",children:(0,c.jsxs)("div",{className:"form-group mb-3",children:[(0,c.jsx)("label",{children:"Name"}),(0,c.jsx)("input",{type:"text",className:"form-control",name:"staff_name",defaultValue:null===P||void 0===P?void 0:P.full_name,placeholder:"Enter Name",autoComplete:"off",required:!0})]})}),(0,c.jsx)("div",{className:"col-md-4",children:(0,c.jsxs)("div",{className:"form-group mb-3",children:[(0,c.jsx)("label",{children:"Email"}),(0,c.jsx)("input",{type:"email",className:"form-control",name:"staff_email",defaultValue:null===P||void 0===P?void 0:P.email,placeholder:"Enter Email",autoComplete:"off",required:!0})]})}),(0,c.jsx)("div",{className:"col-md-4",children:(0,c.jsxs)("div",{className:"form-group mb-3",children:[(0,c.jsx)("label",{children:"Mobile"}),(0,c.jsx)("input",{type:"text",className:"form-control",name:"staff_mobile",defaultValue:null===P||void 0===P?void 0:P.mobile_number,placeholder:"Enter Mobile",autoComplete:"off",required:!0})]})})]}),(0,c.jsx)("div",{className:"row",children:(0,c.jsx)("div",{className:"col-md-12",style:{textAlign:"right"},children:(0,c.jsx)("button",{type:"submit",className:"btn btn-primary",children:"Update"})})})]})}):(0,c.jsx)("div",{className:"card-body",children:(0,c.jsxs)("form",{action:"/",method:"POST",onSubmit:s=>{s.preventDefault();const a=new FormData(s.target),t=a.get("staff_name"),l=a.get("staff_email"),o=a.get("staff_mobile"),i=null==O?v:O,c=a.get("staff_password"),r=a.get("staff_usertype");let d="";"653604248028cba2487f7d2a"==r&&(d=a.get("company"));const m=f,u=h,p=N,x={method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({staff_name:t,staff_email:l,staff_mobile:o,staff_business:i,staff_password:c,staff_lob:m,staff_location:u,staff_id:p,company:d,staff_usertype:r})};console.log("requestOptions",{staff_name:t,staff_email:l,staff_mobile:o,staff_business:i,staff_password:c,staff_lob:m,staff_location:u,staff_id:p,company:d,staff_usertype:r}),fetch("https://insuranceapi-3o5t.onrender.com/api/updateStaff",x).then((e=>e.json())).then((s=>{200===s.status?n().fire({title:"Success",text:s.message,icon:"success",confirmButtonText:"Ok"}).then((s=>{s.isConfirmed&&e("/ViewStaff")})):n().fire({title:"Error",text:s.message,icon:"error",confirmButtonText:"Ok"}).then((s=>{s.isConfirmed&&e("/ViewStaff")}))}))},children:[(0,c.jsxs)("div",{className:"row",children:[(0,c.jsx)("div",{className:"col-md-4",children:(0,c.jsxs)("div",{className:"form-group mb-3",children:[(0,c.jsx)("label",{children:"Name"}),(0,c.jsx)("input",{type:"text",className:"form-control",name:"staff_name",defaultValue:s,placeholder:"Enter Name",autoComplete:"off",required:!0})]})}),(0,c.jsx)("div",{className:"col-md-4",children:(0,c.jsxs)("div",{className:"form-group mb-3",children:[(0,c.jsx)("label",{children:"Email"}),(0,c.jsx)("input",{type:"email",className:"form-control",name:"staff_email",defaultValue:o,placeholder:"Enter Email",autoComplete:"off",required:!0})]})}),(0,c.jsx)("div",{className:"col-md-4",children:(0,c.jsxs)("div",{className:"form-group mb-3",children:[(0,c.jsx)("label",{children:"Mobile"}),(0,c.jsx)("input",{type:"text",className:"form-control",name:"staff_mobile",defaultValue:d,placeholder:"Enter Mobile",autoComplete:"off",required:!0})]})})]}),(0,c.jsxs)("div",{className:"row",children:[(0,c.jsx)("div",{className:"col-md-6",children:(0,c.jsxs)("div",{className:"form-group mb-3",children:[(0,c.jsx)("label",{children:"User Type"}),(0,c.jsxs)("select",{className:"form-control",onClick:e=>(e=>{"653604248028cba2487f7d2a"===e.target.value?G(!0):(G(!1),L(""))})(e),name:"staff_usertype",required:!0,children:[(0,c.jsx)("option",{hidden:!0,value:"",children:"Select User Type"}),C.length>0&&C.map(((e,s)=>(0,c.jsx)("option",{value:e._id,selected:S==e._id,children:e.usertype},s)))]})]})}),1==D?(0,c.jsx)("div",{className:"col-md-6",children:(0,c.jsxs)("div",{className:"form-group mb-3",children:[(0,c.jsx)("label",{children:"Company"}),(0,c.jsxs)("select",{className:"form-control",name:"company",required:!0,children:[(0,c.jsx)("option",{value:"",children:"Select Company"}),null===R||void 0===R?void 0:R.map(((e,s)=>(0,c.jsx)("option",{selected:F==e._id,value:e._id,children:e.company_name},s)))]})]})}):""]}),(0,c.jsxs)("div",{className:"row",children:[(0,c.jsx)("div",{className:"col-md-6",children:(0,c.jsxs)("div",{className:"form-group mb-3",children:[(0,c.jsx)("label",{children:"Location"}),(0,c.jsx)(i.default,{options:j,displayValue:"label",selectedValues:h,onSelect:z,onRemove:z,placeholder:"Select Location",closeOnSelect:!1,avoidHighlightFirstOption:!0,showCheckbox:!0,style:{chips:{background:"#007bff"}},showArrow:!0})]})}),(0,c.jsx)("div",{className:"col-md-6",children:(0,c.jsxs)("div",{className:"form-group mb-3",children:[(0,c.jsx)("label",{children:"Line Of Business"}),(0,c.jsx)(i.default,{options:_,displayValue:"label",selectedValues:f,onSelect:K,onRemove:K,placeholder:"Select Line Of Business",closeOnSelect:!1,avoidHighlightFirstOption:!0,showCheckbox:!0,style:{chips:{background:"#007bff"}},showArrow:!0})]})})]}),(0,c.jsxs)("div",{className:"row",children:[(0,c.jsx)("div",{className:"col-md-6",children:(0,c.jsxs)("div",{className:"form-group mb-3",children:[(0,c.jsx)("label",{children:"Type"}),(0,c.jsx)(i.default,{options:E,displayValue:"label",selectedValues:v,onSelect:V,onRemove:V,placeholder:"Select Type",closeOnSelect:!1,avoidHighlightFirstOption:!0,showCheckbox:!0,style:{chips:{background:"#007bff"}},showArrow:!0})]})}),(0,c.jsx)("div",{className:"col-md-6",children:(0,c.jsxs)("div",{className:"form-group mb-3",children:[(0,c.jsx)("label",{children:"Password"}),(0,c.jsx)("input",{type:"password",className:"form-control",name:"staff_password",placeholder:"Enter Password"})]})})]}),(0,c.jsx)("div",{className:"row",children:(0,c.jsx)("div",{className:"col-md-12",style:{textAlign:"right"},children:(0,c.jsx)("button",{type:"submit",className:"btn btn-primary",children:"Update"})})})]})})]})})})})})})}}}]);
//# sourceMappingURL=4914.081cfb73.chunk.js.map