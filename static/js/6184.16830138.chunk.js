"use strict";(self.webpackChunk_coreui_coreui_free_react_admin_template=self.webpackChunk_coreui_coreui_free_react_admin_template||[]).push([[6184,1072,8691,6310],{16184:(e,n,a)=>{a.r(n),a.d(n,{default:()=>y});var t=a(65043),s=a(92157),o=a.n(s),r=a(73216),l=a(1177),i=a(84217),c=a(53519),d=a(61072),u=a(14282),p=a(73023),h=a.n(p),m=a(30710),f=a(70579);const y=function(e){let{filterOptions:n,defaultOptions:a,updateSharedData:s}=e;const p=(0,r.Zp)(),[y]=(0,t.useState)(5),[g,x]=(0,t.useState)(0),[v,j]=(0,t.useState)(1),[b,_]=(0,t.useState)([]),[S,w]=(0,t.useState)(!1),[C,N]=(0,t.useState)(""),[P,k]=(0,t.useState)(!1),[A,O]=(0,t.useState)({}),[I,T]=(0,t.useState)({}),[D,L]=(0,t.useState)(""),[$,E]=(0,t.useState)(""),[F,R]=(0,t.useState)(""),[B,M]=(0,t.useState)([]),[Y,J]=(0,t.useState)(""),[H,W]=(0,t.useState)(!1),[q,z]=(0,t.useState)([]),[U,V]=(0,t.useState)(0),K=JSON.parse(localStorage.getItem("user")),Z=null===K||void 0===K?void 0:K._id;(0,t.useEffect)((()=>{const e=localStorage.getItem("token");null===e||void 0===e||""===e?p("/login"):Q(v,y)}),[n]);const G=(v-1)*y,Q=async(e,t)=>{k(!0);let s=n.location,o=n.lob,r=n.businessType,l=n.agent,i=n.dateRange,c=a.startdate,d=a.enddate;s=null!=s&&void 0!=s&&Array.isArray(s)&&0!==s.length?s.map((e=>e.value)):a.defaultlocation.map((e=>e.value)),o=null!=o&&void 0!=o&&Array.isArray(o)&&0!==o.length?o.map((e=>e.value)):a.defaultlob.map((e=>e.value)),r=null!=r&&void 0!=r&&Array.isArray(r)&&0!==r.length?r.map((e=>e.value)):a.defaultbusinessType.map((e=>e.value)),l=null!=l&&void 0!=l&&Array.isArray(l)&&0!==l.length?l.map((e=>e.value)):a.defaultagent.map((e=>e.value));const u=localStorage.getItem("token"),p=JSON.parse(localStorage.getItem("user")).usertype,h={method:"POST",body:JSON.stringify({page:e,limit:t,agentid:Z,location:s,lob:o,business_type:r,newagent:l,dateRange:i,startdate:c,enddate:d}),headers:{"Content-Type":"application/json",Authorization:"Bearer "+u}};"6462250eb201a6f07b2dff3a"!=p&&"646224eab201a6f07b2dff36"!=p&&"646224deb201a6f07b2dff32"!=p&&"64622526b201a6f07b2dff3e"!=p||await fetch("https://insuranceapi-3o5t.onrender.com/api/get_supervisor_leads?policyIssuer=pendingPolicyes&dashboardType=policyIssuerDashbord",h).then((e=>e.json())).then((e=>{const n=e.total;V(n);const a=n/t,s=Math.ceil(a);x(s);const o=e.data;_(o)})).catch((e=>{console.log(e)})).finally((()=>{k(!1)})),"64622470b201a6f07b2dff22"==p&&await fetch("https://insuranceapi-3o5t.onrender.com/api/get_supervisor_leads?policyIssuer=pendingPolicyes&dashboardType=policyIssuerDashbord",h).then((e=>e.json())).then((e=>{const n=e.total;V(n);const a=n/t,s=Math.ceil(a);x(s);const o=e.data;_(o)})).catch((e=>{console.log(e)})).finally((()=>{k(!1)}))};return(0,f.jsxs)(f.Fragment,{children:[(0,f.jsx)(l.A,{defaultActiveKey:"0",flush:!0,children:(0,f.jsxs)(l.A.Item,{eventKey:"0",children:[(0,f.jsx)(l.A.Header,{children:(0,f.jsxs)("div",{style:{position:"relative"},className:"card-header new_leads",children:[(0,f.jsx)("strong",{children:"Pending Policies"}),U>0?(0,f.jsx)("div",{className:"dashboardNotify",children:(0,f.jsx)("h6",{children:U})}):""]})}),(0,f.jsxs)(l.A.Body,{className:"scrollavcds",style:{padding:"2px"},children:[(0,f.jsxs)("table",{className:"table table-bordered",children:[(0,f.jsx)("thead",{children:(0,f.jsxs)("tr",{className:"table-info",children:[(0,f.jsx)("th",{scope:"col",children:"Sr"}),(0,f.jsx)("th",{scope:"col",children:"Client Name"}),(0,f.jsx)("th",{scope:"col",children:"Contact Number"}),(0,f.jsx)("th",{scope:"col",children:"Email Address"}),(0,f.jsx)("th",{scope:"col",children:"Received"}),(0,f.jsx)("th",{scope:"col",children:"LOB"}),(0,f.jsx)("th",{scope:"col",children:"Time & Date Recieved"}),(0,f.jsx)("th",{scope:"col",children:"Final Price"}),(0,f.jsx)("th",{scope:"col",children:"View"}),(0,f.jsx)("th",{scope:"col",children:"Issue Policy"})]})}),(0,f.jsx)("tbody",{children:b.length>0?b.map(((e,n)=>{var a,t;return(0,f.jsxs)("tr",{children:[(0,f.jsx)("td",{children:G+n+1}),(0,f.jsx)("td",{children:e.name}),(0,f.jsx)("td",{children:(0,f.jsx)("a",{href:"#",onClick:()=>(e=>{const n=`https://wa.me/${e}`;window.open(n)})(e.phoneno),children:e.phoneno})}),(0,f.jsx)("td",{children:(0,f.jsx)("a",{href:"#",onClick:()=>(e=>{const n=`mailto:${e}`;window.open(n)})(e.email),children:e.email})}),(0,f.jsx)("td",{children:null===(a=e.dc_recived_from[0])||void 0===a?void 0:a.name}),(0,f.jsx)("td",{children:null===(t=e.policy_type[0])||void 0===t?void 0:t.line_of_business_name}),(0,f.jsx)("td",{children:e.assign_policyissuer_timestamp?new Date(e.assign_policyissuer_timestamp).toString():new Date(e.new_lead_timestamp).toString()}),(0,f.jsx)("td",{children:(0,f.jsx)("input",{type:"text",placeholder:"Final Price",defaultValue:e.final_price,onChange:n=>{return a=e._id,t=n.target.value,void O((e=>({...e,[a]:t})));var a,t}})}),(0,f.jsx)("td",{children:(0,f.jsx)("button",{className:"small-btn",onClick:()=>{var n,a,t;return a=e._id,"Motor"===(t=null===(n=e.policy_type[0])||void 0===n?void 0:n.line_of_business_name)&&window.open(`/MotorLeaddetails?id=${a}`,"_blank"),"Travel"===t&&window.open(`/TravelLeaddetails?id=${a}`,"_blank"),"Medical"===t&&window.open(`/MedicalLeaddetails?id=${a}`,"_blank"),"Home"===t&&window.open(`/HomeLeaddetails?id=${a}`,"_blank"),"Yacht"===t&&window.open(`/YachtLeaddetails?id=${a}`,"_blank"),void("Other Insurance"===t&&window.open(`/OtherInsuranceLeaddetails?id=${a}`,"_blank"))},children:(0,f.jsx)("i",{className:"fa fa-eye"})})}),(0,f.jsx)("td",{children:(0,f.jsx)("button",{className:"small-btn",onClick:()=>((e,n)=>{console.log(n),N(e),L(n.email),z(n),w(!0)})(e._id,e),children:"Issue Policy"})})]},n)})):(0,f.jsx)("tr",{children:(0,f.jsx)("td",{colSpan:"12",className:"text-center",children:(0,f.jsx)("strong",{children:"No Records Found"})})})})]}),(0,f.jsxs)("section",{children:[(0,f.jsx)("button",{className:"save-btn",onClick:e=>{try{e.preventDefault();const n="{}"===JSON.stringify(A)?null:A;for(const e in n){const a=n[e],t={method:"POST",body:JSON.stringify({id:e,final_price:a}),headers:{"Content-Type":"application/json"}};fetch("https://insuranceapi-3o5t.onrender.com/api/update_final_price",t).then((e=>e.json())).then((e=>{200===e.status&&(h()("Success","Updated Successfully","success"),Q(v,y))})).catch((e=>{console.log(e)}))}}catch(n){console.log(n)}},children:"Save"}),(0,f.jsx)(o(),{previousLabel:"Previous",nextLabel:"Next",breakLabel:"...",pageCount:g,marginPagesDisplayed:1,pageRangeDisplayed:1,onPageChange:e=>{const n=e.selected;j(n+1),Q(n+1,y,localStorage.getItem("lob"))},containerClassName:"pagination justify-content-end",pageClassName:"page-item",pageLinkClassName:"page-link",previousClassName:"page-item",previousLinkClassName:"page-link",nextClassName:"page-item",nextLinkClassName:"page-link",breakClassName:"page-item",breakLinkClassName:"page-link",activeClassName:"active"})]})]})]})}),(0,f.jsx)(i.A,{size:"lg",show:S,onHide:()=>w(!1),scrollable:!0,children:P?(0,f.jsxs)(f.Fragment,{children:[(0,f.jsx)(i.A.Header,{closeButton:!0,style:{backgroundColor:"#0D2F92",color:"#ffff"},children:(0,f.jsx)(i.A.Title,{children:"Issue Policy"})}),(0,f.jsx)(i.A.Body,{children:(0,f.jsx)("div",{className:"loader-container",children:(0,f.jsx)(m.A,{color:"#ED1C24",loading:P,size:50})})})]}):(0,f.jsxs)(f.Fragment,{children:[(0,f.jsx)(i.A.Header,{closeButton:!0,style:{backgroundColor:"#0D2F92",color:"#ffff"},children:(0,f.jsx)(i.A.Title,{children:"Issue Policy"})}),(0,f.jsx)(i.A.Body,{children:(0,f.jsxs)(c.A,{children:[(0,f.jsxs)(d.A,{children:[(0,f.jsx)("label",{children:(0,f.jsx)("strong",{children:"Purchased Policy Number"})}),(0,f.jsx)("input",{type:"text",className:"form-control",name:"purchasedPolicy",id:"purchasedPolicy",onChange:e=>T(e.target.value)})]}),(0,f.jsxs)(d.A,{children:[(0,f.jsx)("label",{children:(0,f.jsxs)("strong",{children:["To ",(0,f.jsx)("span",{style:{color:"red"},children:"*"})]})}),(0,f.jsx)("input",{type:"email",className:"form-control",name:"to",id:"to",defaultValue:D,onChange:e=>L(e.target.value),required:!0})]}),(0,f.jsxs)(d.A,{children:[(0,f.jsx)("label",{children:(0,f.jsx)("strong",{children:"CC"})}),(0,f.jsx)("input",{type:"text",className:"form-control",name:"cc",id:"cc",value:$,onChange:e=>E(e.target.value)})]}),(0,f.jsxs)(d.A,{children:[(0,f.jsx)("label",{children:(0,f.jsxs)("strong",{children:["Message ",(0,f.jsx)("span",{style:{color:"red"},children:"*"})]})}),(0,f.jsx)("textarea",{className:"form-control",name:"message",id:"message",onChange:e=>R(e.target.value),cols:"30",rows:"10",required:!0,children:`\n  Dear ${null===q||void 0===q?void 0:q.name},\n\n  We are pleased to inform you that your insurance policy has been successfully issued. Below is the summary of your policy details:\n\n  Policy Number: [Policy Number]\n  Policy Start Date: [Policy Start Date]\n  Policy End Date: [Policy End Date]\n\n  Please review the policy document attached for a comprehensive understanding of your coverage and terms. If you have any questions or require further assistance, feel free to contact our customer support team at [Customer Support Email] or [Customer Support Phone Number].\n\n  Thank you for choosing [Your Insurance Company Name] for your insurance needs. We look forward to serving you.\n\n  Best regards,\n  [Your Name]\n  [Your Title]\n  [Your Insurance Company Name]\n  [Contact Information]\n  `})]}),(0,f.jsxs)(d.A,{children:[(0,f.jsx)("label",{children:(0,f.jsxs)("strong",{children:["Upload Documents ",(0,f.jsx)("span",{style:{color:"red"},children:"*"})]})}),(0,f.jsx)("input",{type:"file",className:"form-control",name:"emaildocumentfiles",id:"emaildocumentfiles",multiple:!0,required:!0,onChange:e=>{const n=Array.from(e.target.files);M(n)}})]})]})}),(0,f.jsxs)(i.A.Footer,{children:[(0,f.jsx)(u.A,{variant:"primary",onClick:e=>{try{if(""===D)return h()("Warning","Please fill To fields","warning"),!1;if(!D.includes("@")||!D.includes("."))return h()("Warning","Please enter a valid email address","warning"),!1;if(""===F)return h()("Warning","The email body is empty","warning"),!1;if(0===B.length)return h()("Warning","Please upload the document","warning"),!1;{k(!0),e.preventDefault();const n=new FormData;n.append("purchasedPolicy",I),n.append("to",D),n.append("cc",$),n.append("message",F),n.append("id",C),n.append("policy_issued_by",Z),n.append("policy_issued_status",1),n.append("lead_status","Closed"),B.forEach(((e,a)=>{n.append("file",e)}));const a=new Date;n.append("policy_issued_date",a.toISOString());const t=new Date;t.setFullYear(t.getFullYear()+1),n.append("policy_expiry_date",t.toISOString()),fetch("https://insuranceapi-3o5t.onrender.com/api/Send_Email",{method:"POST",body:n}).then((e=>e.json())).then((e=>{if(200===e.status){var n;const e=null===q||void 0===q||null===(n=q.policy_type[0])||void 0===n?void 0:n.line_of_business_name;fetch("https://insuranceapi-3o5t.onrender.com/api/addThiredPartyComission",{method:"POST",body:JSON.stringify({leadId:C,lobType:e}),headers:{"Content-Type":"application/json"}}),h()("Success","Email Sent Successfully","success"),Q(v,y),w(!1),s(Q(v,y))}})).catch((e=>{console.error("Error:",e)})).finally((()=>{k(!0)}))}}catch(n){console.log(n)}},children:"Submit"}),(0,f.jsx)(u.A,{variant:"dark",onClick:()=>w(!1),children:"Close"})]})]})})]})}},61072:(e,n,a)=>{a.d(n,{A:()=>c});var t=a(98139),s=a.n(t),o=a(65043),r=a(67852),l=a(70579);const i=o.forwardRef(((e,n)=>{let{bsPrefix:a,className:t,as:o="div",...i}=e;const c=(0,r.oU)(a,"row"),d=(0,r.gy)(),u=(0,r.Jm)(),p=`${c}-cols`,h=[];return d.forEach((e=>{const n=i[e];let a;delete i[e],null!=n&&"object"===typeof n?({cols:a}=n):a=n;const t=e!==u?`-${e}`:"";null!=a&&h.push(`${p}${t}-${a}`)})),(0,l.jsx)(o,{ref:n,...i,className:s()(t,c,...h)})}));i.displayName="Row";const c=i},30710:(e,n,a)=>{a.d(n,{A:()=>c});var t=a(65043),s={cm:!0,mm:!0,in:!0,px:!0,pt:!0,pc:!0,em:!0,ex:!0,ch:!0,rem:!0,vw:!0,vh:!0,vmin:!0,vmax:!0,"%":!0};function o(e){var n=function(e){if("number"===typeof e)return{value:e,unit:"px"};var n,a=(e.match(/^[0-9.]*/)||"").toString();n=a.includes(".")?parseFloat(a):parseInt(a,10);var t=(e.match(/[^0-9]*$/)||"").toString();return s[t]?{value:n,unit:t}:(console.warn("React Spinners: ".concat(e," is not a valid css value. Defaulting to ").concat(n,"px.")),{value:n,unit:"px"})}(e);return"".concat(n.value).concat(n.unit)}var r=function(){return r=Object.assign||function(e){for(var n,a=1,t=arguments.length;a<t;a++)for(var s in n=arguments[a])Object.prototype.hasOwnProperty.call(n,s)&&(e[s]=n[s]);return e},r.apply(this,arguments)},l=function(e,n){var a={};for(var t in e)Object.prototype.hasOwnProperty.call(e,t)&&n.indexOf(t)<0&&(a[t]=e[t]);if(null!=e&&"function"===typeof Object.getOwnPropertySymbols){var s=0;for(t=Object.getOwnPropertySymbols(e);s<t.length;s++)n.indexOf(t[s])<0&&Object.prototype.propertyIsEnumerable.call(e,t[s])&&(a[t[s]]=e[t[s]])}return a},i=function(e,n,a){var t="react-spinners-".concat(e,"-").concat(a);if("undefined"==typeof window||!window.document)return t;var s=document.createElement("style");document.head.appendChild(s);var o=s.sheet,r="\n    @keyframes ".concat(t," {\n      ").concat(n,"\n    }\n  ");return o&&o.insertRule(r,0),t}("ClipLoader","0% {transform: rotate(0deg) scale(1)} 50% {transform: rotate(180deg) scale(0.8)} 100% {transform: rotate(360deg) scale(1)}","clip");const c=function(e){var n=e.loading,a=void 0===n||n,s=e.color,c=void 0===s?"#000000":s,d=e.speedMultiplier,u=void 0===d?1:d,p=e.cssOverride,h=void 0===p?{}:p,m=e.size,f=void 0===m?35:m,y=l(e,["loading","color","speedMultiplier","cssOverride","size"]),g=r({background:"transparent !important",width:o(f),height:o(f),borderRadius:"100%",border:"2px solid",borderTopColor:c,borderBottomColor:"transparent",borderLeftColor:c,borderRightColor:c,display:"inline-block",animation:"".concat(i," ").concat(.75/u,"s 0s infinite linear"),animationFillMode:"both"},h);return a?t.createElement("span",r({style:g},y)):null}}}]);
//# sourceMappingURL=6184.16830138.chunk.js.map