(self.webpackChunk_coreui_coreui_free_react_admin_template=self.webpackChunk_coreui_coreui_free_react_admin_template||[]).push([[7476],{87476:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>p});var n=s(65043),a=s(73216),o=s(92157),l=s.n(o),i=s(73023),c=s.n(i),r=(s(413),s(93946)),d=(s(72450),s(54168)),m=s(84217),u=s(14282),h=s(70579);const p=()=>{var e;const t=(0,a.Zp)(),[s,o]=(0,n.useState)([]),[i]=(0,n.useState)(20),[p,j]=(0,n.useState)(0),[v,x]=(0,n.useState)(1),[f,b]=(0,n.useState)(""),[g,y]=(0,n.useState)([]),[N,w]=(0,n.useState)(""),[S,_]=(0,n.useState)(""),[C,k]=(0,n.useState)(!1),[T,E]=(0,n.useState)(!1),[A,D]=(0,n.useState)(!1),[L,B]=(0,n.useState)([]),[O,R]=(0,n.useState)(""),[q,U]=(0,n.useState)([]),[F,H]=(0,n.useState)([]),[P,M]=(0,n.useState)(""),[G,V]=(0,n.useState)(""),[J,$]=(0,n.useState)([]),[I,z]=(0,n.useState)([]);(0,n.useEffect)((()=>{const e=localStorage.getItem("token");if(null===e||void 0===e||""===e)t("/login");else{var s;Q(v,i),X(),W(),K();const e=JSON.parse(localStorage.getItem("user")),t=(null===e||void 0===e||null===(s=e.master_permission)||void 0===s?void 0:s[0])||{};B(t)}}),[]);const Q=(e,t)=>{o([]);fetch(`https://insuranceapi-3o5t.onrender.com/api/getAllBusinessEntityDiscounts?page=${e}&limit=${t}`,{method:"GET",headers:{"Content-Type":"application/json"}}).then((e=>e.json())).then((e=>{R(e.message);const s=e.count/t,n=Math.ceil(s);j(n);const a=e.data;console.log(a,">>>>> list"),o(a)}))},X=()=>{const e=JSON.parse(localStorage.getItem("user")).line_of_business;if(e.length>0){const t=e,s=t.length,n=[];for(let e=0;e<s;e++){const s={label:t[e].lob_name,value:t[e].lob_id};n.push(s)}U(n)}else{fetch("https://insuranceapi-3o5t.onrender.com/api/get_line_of_business_list",{method:"GET",headers:{"Content-Type":"application/json"}}).then((e=>e.json())).then((e=>{const t=e.data,s=t.length,n=[];for(let a=0;a<s;a++){const e={label:t[a].line_of_business_name,value:t[a]._id};n.push(e)}U(n)}))}},K=()=>{fetch("https://insuranceapi-3o5t.onrender.com/api/getCompany",{method:"GET",headers:{"Content-Type":"application/json"}}).then((e=>e.json())).then((e=>{const t=e.data,s=[];for(let n=0;n<t.length;n++){const e={label:t[n].company_name,value:t[n]._id};s.push(e)}$(s)}))},W=()=>{fetch("https://insuranceapi-3o5t.onrender.com/api/get_location",{method:"GET",headers:{"Content-Type":"application/json"}}).then((e=>e.json())).then((e=>{const t=e.data,s=t.length,n=[];for(let a=0;a<s;a++)if("Head Office"!=t[a].location_name){const e={label:t[a].location_name,value:t[a]._id};n.push(e)}y(n)}))},Z=(e,t)=>{const s={method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({be_status:t,id:e})};fetch("https://insuranceapi-3o5t.onrender.com/api/UpdateBusinessEntityDiscountStatus",s).then((e=>e.json())).then((e=>{200===e.status?(c()({text:e.message,icon:"success",button:!1}),Q(v,i),setTimeout((()=>{c().close()}),"1000")):(c()({title:"Error!",text:e.message,icon:"error",button:!1}),Q(v,i),setTimeout((()=>{c().close()}),"1000"))}))},[Y,ee]=(0,n.useState)([]),[te,se]=(0,n.useState)([]),ne=(v-1)*i;return(0,h.jsxs)(h.Fragment,{children:[(0,h.jsx)("div",{className:"container",children:(0,h.jsx)("div",{className:"row",children:(0,h.jsx)("div",{className:"col-md-12",children:(0,h.jsxs)("div",{className:"card",children:[(0,h.jsx)("div",{className:"card-header",children:(0,h.jsxs)("div",{className:"row",children:[(0,h.jsx)("div",{className:"col-md-6",children:(0,h.jsx)("h4",{className:"card-title",children:"BE Discount"})}),(0,h.jsx)("div",{className:"col-md-6",children:null!==(e=L.be_discount)&&void 0!==e&&e.includes("create")?(0,h.jsx)("button",{className:"btn btn-primary",style:{float:"right"},onClick:()=>(H([]),void E(!0)),children:"Add BE Discount"}):""})]})}),(0,h.jsx)("div",{className:"card-body",children:(0,h.jsxs)("div",{className:"table-responsive",children:[(0,h.jsxs)("table",{className:"table table-bordered",children:[(0,h.jsx)("thead",{className:" text-primary",children:(0,h.jsxs)("tr",{children:[(0,h.jsx)("th",{children:"#"}),(0,h.jsx)("th",{children:"Location"}),(0,h.jsx)("th",{children:"Description"}),(0,h.jsx)("th",{children:"LOB"}),(0,h.jsx)("th",{children:"Company"}),(0,h.jsx)("th",{children:"Rate"}),(0,h.jsx)("th",{children:"Action"})]})}),(0,h.jsx)("tbody",{children:s&&s.length>0?(0,h.jsx)(h.Fragment,{children:null===s||void 0===s?void 0:s.map(((e,t)=>{var s,n,a,o,l;return(0,h.jsxs)("tr",{children:[(0,h.jsx)("td",{children:ne+t+1}),(0,h.jsx)("td",{children:null===(s=e.locatins)||void 0===s?void 0:s.map((e=>e.location_name)).join(", ")}),(0,h.jsx)("td",{children:e.desciption}),(0,h.jsx)("td",{children:null===(n=e.lobDetails)||void 0===n?void 0:n.map((e=>e.line_of_business_name)).join(", ")}),(0,h.jsx)("td",{children:null===(a=e.company)||void 0===a?void 0:a.map((e=>e.company_name)).join(", ")}),(0,h.jsx)("td",{children:e.rate}),(0,h.jsxs)("td",{children:[(null===(o=L.be_discount)||void 0===o?void 0:o.includes("edit"))&&(0,h.jsx)("button",{className:"btn btn-primary",onClick:()=>{return t=e._id,_(t),H([]),void fetch(`https://insuranceapi-3o5t.onrender.com/api/getSingleBusinessEntityDiscount?id=${t}`,{method:"GET",headers:{"Content-Type":"application/json"}}).then((e=>e.json())).then((e=>{var t;const s=e.data;console.log(s,">>>>>>>>>>>>>>>>>>"),M(s.desciption),V(s.rate),w(s.location),H(s.lob),console.log(s.company,">>>>>>>>>>>>>>>>>>");const n=null===(t=s.company)||void 0===t?void 0:t.map((e=>({label:e.company_name,value:e.company_id})));se(n),z(n),D(!0)}));var t},children:"Edit"})," ",(null===(l=L.be_discount)||void 0===l?void 0:l.includes("delete"))&&(0,h.jsxs)(h.Fragment,{children:[!0===e.status?(0,h.jsx)("button",{className:"btn btn-danger",onClick:()=>{window.confirm("Are you sure you wish to deactivate this item?")&&Z(e._id,!1)},children:"Deactivate"}):(0,h.jsx)("button",{className:"btn btn-success",onClick:()=>{window.confirm("Are you sure you wish to activate this item?")&&Z(e._id,!0)},children:"Activate"}),(0,h.jsx)("button",{className:"btn btn-warning mx-1",onClick:()=>{window.confirm("Are you sure you wish to delete this item?")&&(async e=>{await fetch(`https://insuranceapi-3o5t.onrender.com/api/deleteMasterData?id=${e}&type=bediscount`,{method:"DELETE",headers:{"Content-Type":"application/json"}}).then((e=>e.json())).then((e=>{200===e.status?(c()({title:"Success!",text:e.message,icon:"success",button:!1}),Q(v,i),setTimeout((()=>{c().close()}),1e3)):(c()({title:"Error!",text:e.message,icon:"error",button:!1}),Q(v,i),setTimeout((()=>{c().close()}),1e3))}))})(e._id)},children:"Delete"})]})]})]},t)}))}):(0,h.jsx)("tr",{children:(0,h.jsx)("td",{colSpan:"17",style:{textAlign:"center"},children:(0,h.jsx)("strong",{children:O})})})})]}),(0,h.jsx)(l(),{previousLabel:"Previous",nextLabel:"Next",breakLabel:"...",pageCount:p,marginPagesDisplayed:2,pageRangeDisplayed:3,onPageChange:e=>{const t=e.selected;x(t+1),Q(t+1,i)},containerClassName:"pagination justify-content-end",pageClassName:"page-item",pageLinkClassName:"page-link",previousClassName:"page-item",previousLinkClassName:"page-link",nextClassName:"page-item",nextLinkClassName:"page-link",breakClassName:"page-item",breakLinkClassName:"page-link",activeClassName:"active"})]})})]})})})}),(0,h.jsxs)(r.zS,{alignment:"center",visible:C,onClose:()=>k(!1),children:[(0,h.jsx)(r.E4,{onClose:()=>k(!1),children:(0,h.jsx)(r.lb,{children:"Upload Excel File"})}),(0,h.jsx)(r.Tc,{children:(0,h.jsx)("div",{children:(0,h.jsx)("input",{type:"file",className:"form-control",id:"DHA",defaultValue:"",required:!0,onChange:e=>b(e.target.files[0])})})}),(0,h.jsxs)(r.If,{children:[(0,h.jsx)(r.Q_,{color:"secondary",onClick:()=>k(!1),children:"Close"}),(0,h.jsx)(r.Q_,{color:"primary",onClick:async e=>{e.preventDefault();const t=new FormData;t.append("file",f);let s=await fetch("https://insuranceapi-3o5t.onrender.com/api/read_make_motor_excel ",{method:"post",body:t});s=await s.json(),k(!C),console.log(s.success),!0===s.success?c()("Uploaded Succesfully","","success"):c()("Something went wrong","","failed"),Q(v,i)},href:"/motor-make",children:"Upload"})]})]}),(0,h.jsxs)(m.A,{size:"lg",show:T,onHide:()=>E(!1),children:[(0,h.jsx)(m.A.Header,{closeButton:!0,children:(0,h.jsx)(m.A.Title,{children:"Add BE Discount"})}),(0,h.jsx)(m.A.Body,{children:(0,h.jsx)("div",{className:"container",children:(0,h.jsx)("div",{className:"row",children:(0,h.jsx)("div",{className:"col-md-12",children:(0,h.jsx)("div",{className:"card",children:(0,h.jsx)("div",{className:"card-body",children:(0,h.jsxs)("form",{action:"/",method:"POST",onSubmit:e=>{try{e.preventDefault();const t=new FormData(e.target),s=t.get("description"),n=t.get("loc"),a=t.get("rate"),o=F,l=a.includes(",")?a.split(","):[a];if(0!=o.length&&o!=[]&&void 0!=o||c()("Please select lob","","warning"),0==I.length||void 0==I)c()("Please Select Company","","warning");else if(I.length!=l.length)c()("rate must be equal to Companies selected","","warning");else{console.log("ready to submit");const e={method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({desciption:s,rate:a,lob:o,location:n,company:null===I||void 0===I?void 0:I.map((e=>({id:e.value,company_name:e.label})))})};fetch("https://insuranceapi-3o5t.onrender.com/api/addBusinessEntityDiscount",e).then((e=>e.json())).then((e=>{201==e.status?(E(!1),c()({text:e.message,type:"success",icon:"success",button:!1}),Q(v,i),setTimeout((()=>{c().close()}),1e3)):(E(!1),c()({text:e.message,type:"error",icon:"error",button:!1}),Q(v,i),setTimeout((()=>{c().close()}),1e3))}))}}catch(t){console.log(t)}},children:[(0,h.jsxs)("div",{className:"row",children:[(0,h.jsx)("div",{className:"col-md-6",children:(0,h.jsxs)("div",{className:"form-group",children:[(0,h.jsx)("label",{className:"form-label",children:"Select Location"}),(0,h.jsxs)("select",{className:"form-control",name:"loc",required:!0,children:[(0,h.jsx)("option",{value:"",hidden:!0,children:"Select Location"}),null===g||void 0===g?void 0:g.map(((e,t)=>(0,h.jsx)("option",{value:e.value,children:e.label},t)))]})]})}),(0,h.jsx)("div",{className:"col-md-6",children:(0,h.jsxs)("div",{className:"form-group",children:[(0,h.jsx)("label",{className:"form-label",children:"Description"}),(0,h.jsx)("input",{type:"text",className:"form-control",name:"description",placeholder:"Description",autoComplete:"off",required:!0})]})}),(0,h.jsx)("div",{className:"col-md-6",children:(0,h.jsxs)("div",{className:"form-group",children:[(0,h.jsx)("label",{className:"form-label",children:"Select Line Of Business"}),(0,h.jsxs)("select",{className:"form-control",name:"lob",required:!0,onChange:e=>H(e.target.value),children:[(0,h.jsx)("option",{value:"",hidden:!0,children:"Select Line Of Business"}),null===q||void 0===q?void 0:q.map(((e,t)=>(0,h.jsx)("option",{value:e.value,children:e.label},t)))]})]})}),(0,h.jsx)("div",{className:"col-md-6",children:(0,h.jsxs)("div",{className:"form-group",children:[(0,h.jsx)("label",{className:"form-label",children:"Select Company"}),(0,h.jsx)(d.default,{options:J,displayValue:"label",onSelect:z,onRemove:z,placeholder:"Select line of business",showArrow:!0,showCheckbox:!0,required:!0})]})}),(0,h.jsx)("div",{className:"col-md-6",children:(0,h.jsxs)("div",{className:"form-group",children:[(0,h.jsx)("label",{className:"form-label",children:"Rate(%)"}),(0,h.jsx)("input",{type:"text",className:"form-control",name:"rate",placeholder:"Rate",autoComplete:"off",required:!0})]})})]}),(0,h.jsx)("div",{className:"row",children:(0,h.jsx)("div",{className:"col-md-12",children:(0,h.jsx)("button",{type:"submit",className:"btn btn-primary mt-2 submit_all",style:{float:"right"},children:"Submit"})})})]})})})})})})}),(0,h.jsx)(m.A.Footer,{children:(0,h.jsx)(u.A,{variant:"secondary",onClick:()=>E(!1),children:"Close"})})]}),(0,h.jsxs)(m.A,{size:"lg",show:A,onHide:()=>D(!1),children:[(0,h.jsx)(m.A.Header,{closeButton:!0,children:(0,h.jsx)(m.A.Title,{children:"Edit BE Discount"})}),(0,h.jsx)(m.A.Body,{children:(0,h.jsx)("div",{className:"container",children:(0,h.jsx)("div",{className:"row",children:(0,h.jsx)("div",{className:"col-md-12",children:(0,h.jsx)("div",{className:"card",children:(0,h.jsx)("div",{className:"card-body",children:(0,h.jsxs)("form",{action:"/",method:"POST",onSubmit:e=>{e.preventDefault();const t=new FormData(e.target),s=t.get("loc"),n=t.get("lob"),a=t.get("be_rate"),o=t.get("be_desc"),l=F,r=a.includes(",")?a.split(","):[a];if(console.log(l.length," : ",r.length),0==l.length||l==[]||void 0==l)c()("Please select Line of business","","warning");else if(0==I.length||void 0==I)c()("Please Select Company","","warning");else if(r.length!=I.length)c()("rate must be equal to Companies selected","","warning");else{const e={method:"put",headers:{"Content-Type":"application/json"},body:JSON.stringify({desciption:o,rate:a,lob:n,location:s,company:null===I||void 0===I?void 0:I.map((e=>({id:e.value,company_name:e.label})))})};fetch(`https://insuranceapi-3o5t.onrender.com/api/UpdateBusinessEntityDiscount?id=${S}`,e).then((e=>e.json())).then((e=>{200===e.status?(D(!1),c()({text:e.message,icon:"success",button:!1}),Q(v,i),setTimeout((()=>{c().close()}),1e3)):(D(!1),c()({title:"Error!",text:e.message,icon:"error",button:!1}),Q(v,i),setTimeout((()=>{c().close()}),1e3))}))}},children:[(0,h.jsxs)("div",{className:"row",children:[(0,h.jsx)("div",{className:"col-md-6",children:(0,h.jsxs)("div",{className:"form-group",children:[(0,h.jsx)("label",{className:"form-label",children:"Location"}),(0,h.jsx)("select",{className:"form-control",name:"loc",required:!0,children:null===g||void 0===g?void 0:g.map(((e,t)=>(0,h.jsx)("option",{selected:e.value==N,value:e.value,children:e.label},t)))})]})}),(0,h.jsx)("div",{className:"col-md-6",children:(0,h.jsxs)("div",{className:"form-group",children:[(0,h.jsx)("label",{className:"form-label",children:"Description"}),(0,h.jsx)("input",{type:"text",className:"form-control",name:"be_desc",placeholder:"Description",defaultValue:P,autoComplete:"off",required:!0})]})}),(0,h.jsx)("div",{className:"col-md-6",children:(0,h.jsxs)("div",{className:"form-group",children:[(0,h.jsx)("label",{className:"form-label",children:"Line Of Buisness"}),(0,h.jsxs)("select",{className:"form-control",name:"lob",required:!0,children:[(0,h.jsx)("option",{value:"",hidden:!0,children:"Select Line Of Business"}),null===q||void 0===q?void 0:q.map(((e,t)=>(0,h.jsx)("option",{selected:e.value==F,value:e.value,children:e.label},t)))]})]})}),(0,h.jsx)("div",{className:"col-md-6",children:(0,h.jsxs)("div",{className:"form-group",children:[(0,h.jsx)("label",{className:"form-label",children:"Select Company"}),(0,h.jsx)(d.default,{options:J,selectedValues:te,displayValue:"label",onSelect:z,onRemove:z,placeholder:"Select line of business",showArrow:!0,showCheckbox:!0,required:!0})]})}),(0,h.jsx)("div",{className:"col-md-6",children:(0,h.jsxs)("div",{className:"form-group",children:[(0,h.jsx)("label",{className:"form-label",children:"Rate(%)"}),(0,h.jsx)("input",{type:"text",className:"form-control",name:"be_rate",placeholder:"Rate",defaultValue:G,autoComplete:"off",required:!0})]})})]}),(0,h.jsx)("div",{className:"row",children:(0,h.jsx)("div",{className:"col-md-12",children:(0,h.jsx)("button",{type:"submit",className:"btn btn-primary mt-2 submit_all",style:{float:"right"},children:"Update"})})})]})})})})})})}),(0,h.jsx)(m.A.Footer,{children:(0,h.jsx)(u.A,{variant:"secondary",onClick:()=>D(!1),children:"Close"})})]})]})}},72450:function(e,t,s){var n,a,o;a=[],void 0===(o="function"===typeof(n=function(){"use strict";function t(e,t){return"undefined"==typeof t?t={autoBom:!1}:"object"!=typeof t&&(console.warn("Deprecated: Expected third argument to be a object"),t={autoBom:!t}),t.autoBom&&/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(e.type)?new Blob(["\ufeff",e],{type:e.type}):e}function n(e,t,s){var n=new XMLHttpRequest;n.open("GET",e),n.responseType="blob",n.onload=function(){c(n.response,t,s)},n.onerror=function(){console.error("could not download file")},n.send()}function a(e){var t=new XMLHttpRequest;t.open("HEAD",e,!1);try{t.send()}catch(e){}return 200<=t.status&&299>=t.status}function o(e){try{e.dispatchEvent(new MouseEvent("click"))}catch(n){var t=document.createEvent("MouseEvents");t.initMouseEvent("click",!0,!0,window,0,0,0,80,20,!1,!1,!1,!1,0,null),e.dispatchEvent(t)}}var l="object"==typeof window&&window.window===window?window:"object"==typeof self&&self.self===self?self:"object"==typeof s.g&&s.g.global===s.g?s.g:void 0,i=l.navigator&&/Macintosh/.test(navigator.userAgent)&&/AppleWebKit/.test(navigator.userAgent)&&!/Safari/.test(navigator.userAgent),c=l.saveAs||("object"!=typeof window||window!==l?function(){}:"download"in HTMLAnchorElement.prototype&&!i?function(e,t,s){var i=l.URL||l.webkitURL,c=document.createElement("a");t=t||e.name||"download",c.download=t,c.rel="noopener","string"==typeof e?(c.href=e,c.origin===location.origin?o(c):a(c.href)?n(e,t,s):o(c,c.target="_blank")):(c.href=i.createObjectURL(e),setTimeout((function(){i.revokeObjectURL(c.href)}),4e4),setTimeout((function(){o(c)}),0))}:"msSaveOrOpenBlob"in navigator?function(e,s,l){if(s=s||e.name||"download","string"!=typeof e)navigator.msSaveOrOpenBlob(t(e,l),s);else if(a(e))n(e,s,l);else{var i=document.createElement("a");i.href=e,i.target="_blank",setTimeout((function(){o(i)}))}}:function(e,t,s,a){if((a=a||open("","_blank"))&&(a.document.title=a.document.body.innerText="downloading..."),"string"==typeof e)return n(e,t,s);var o="application/octet-stream"===e.type,c=/constructor/i.test(l.HTMLElement)||l.safari,r=/CriOS\/[\d]+/.test(navigator.userAgent);if((r||o&&c||i)&&"undefined"!=typeof FileReader){var d=new FileReader;d.onloadend=function(){var e=d.result;e=r?e:e.replace(/^data:[^;]*;/,"data:attachment/file;"),a?a.location.href=e:location=e,a=null},d.readAsDataURL(e)}else{var m=l.URL||l.webkitURL,u=m.createObjectURL(e);a?a.location=u:location.href=u,a=null,setTimeout((function(){m.revokeObjectURL(u)}),4e4)}});l.saveAs=c.saveAs=c,e.exports=c})?n.apply(t,a):n)||(e.exports=o)},413:(e,t,s)=>{"use strict";e.exports=s.p+"static/media/motor-make.b21b29b3a03d12061f79.xlsx"}}]);
//# sourceMappingURL=7476.24c79a0a.chunk.js.map