"use strict";(self.webpackChunk_coreui_coreui_free_react_admin_template=self.webpackChunk_coreui_coreui_free_react_admin_template||[]).push([[2329],{2329:(e,s,a)=>{a.r(s),a.d(s,{default:()=>r});var l=a(65043),t=a(73216),o=a(73023),n=a.n(o),c=a(54168),i=a(70579);const r=()=>{const e=(0,t.Zp)(),[s,a]=(0,l.useState)([]),[o,r]=(0,l.useState)([]),[d,m]=(0,l.useState)([]),[h,p]=(0,l.useState)(null),[u,f]=(0,l.useState)([]),[j,x]=(0,l.useState)([]),[v,b]=(0,l.useState)(null),[g,_]=(0,l.useState)([]),[N,y]=(0,l.useState)([]),[S,w]=(0,l.useState)([]);(0,l.useEffect)((()=>{const s=localStorage.getItem("token");if(null===s||void 0===s||""===s)e("/login");else{T(),O(),C();x([{label:"New Business",value:"New Business"},{label:"Renewal Business",value:"Renewal Business"}])}}),[]),(0,l.useEffect)((()=>{console.log("i worked toooooooooooooooooooo"),console.log(u,"staff_location"),k()}),[u]);const C=()=>{fetch("https://insuranceapi-3o5t.onrender.com/api/getCompany",{method:"GET",headers:{"Content-Type":"application/json"}}).then((e=>e.json())).then((e=>{w(e.data)}))},T=()=>{fetch("https://insuranceapi-3o5t.onrender.com/api/get_location",{method:"GET",headers:{"Content-Type":"application/json"}}).then((e=>e.json())).then((e=>{const s=e.data;console.log(s);const l=s.length,t=[];for(let a=0;a<l;a++){const e={label:s[a].location_name,value:s[a]._id};t.push(e)}a(t),f(t)}))};console.log(s),console.log(u);const k=()=>{const e=null==u||0==u.length?s.map((e=>e.value)):u.map((e=>e.value)),a=new URLSearchParams;e.forEach((e=>{a.append("location",e)})),fetch(`https://insuranceapi-3o5t.onrender.com/api/get_line_of_business_list?${a.toString()}`,{method:"GET",headers:{"Content-Type":"application/json"}}).then((e=>e.json())).then((e=>{const s=e.data,a=s.length,l=[];for(let t=0;t<a;t++){const e={label:s[t].line_of_business_name,value:s[t]._id};l.push(e)}r(l)}))},E=e=>{f(e)},O=()=>{fetch("https://insuranceapi-3o5t.onrender.com/api/get_user_type",{method:"GET",headers:{"Content-Type":"application/json"}}).then((e=>e.json())).then((e=>{m(e.data)}))},V=e=>{fetch(`https://insuranceapi-3o5t.onrender.com/api/update_user_permission/${e}`,{method:"PUT",headers:{"Content-Type":"application/json"}}).then((e=>e.json())).then((e=>{const s=B(e.data),a=JSON.stringify(s,null,2);_(JSON.parse(a))}))};console.log("permission>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>",g);const B=e=>{const s=[];for(const a in e[0]){const l=e[0][a][0],t=a.split("_")[0],o={module_name:t.charAt(0).toUpperCase()+t.slice(1),permission:[{...l,_id:"64a3b25ba1f5ea6cfdbad390",__v:0}]};s.push(o)}return s};return(0,i.jsx)("div",{className:"container",children:(0,i.jsx)("div",{className:"row",children:(0,i.jsx)("div",{className:"col-md-12",children:(0,i.jsx)("div",{className:"card",style:{marginTop:"20px"},children:(0,i.jsx)("div",{className:"card-header",children:(0,i.jsxs)("div",{className:"row",children:[(0,i.jsx)("div",{className:"col-md-6",children:(0,i.jsx)("h4",{className:"card-title",children:"Add Staff"})}),(0,i.jsx)("div",{className:"col-md-6",children:(0,i.jsx)("a",{href:"/ViewStaff",className:"btn btn-primary",style:{float:"right"},children:"Back"})}),(0,i.jsx)("div",{className:"card-body",children:(0,i.jsxs)("form",{action:"/",method:"POST",onSubmit:a=>{a.preventDefault();const l=new FormData(a.target),t=l.get("staff_name"),c=l.get("staff_email"),i=l.get("staff_mobile"),r=l.get("staff_usertype"),d=l.get("staff_password"),m=l.get("company"),p=null==h?o.length:h.length,f=[];for(let e=0;e<p;e++)null==h?f.push(o[e].value):f.push(h[e].value);const j=null==u?s.length:u.length,x=[];for(let e=0;e<j;e++)null==u?x.push(s[e].value):x.push(u[e].value);const b=v.length,g=[];for(let e=0;e<b;e++)g.push(v[e].value);const _={method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({staff_name:t,staff_email:c,staff_mobile:i,staff_usertype:r,staff_business:g,staff_password:d,company:m,staff_lob:f,staff_location:x})};fetch("https://insuranceapi-3o5t.onrender.com/api/addStaff",_).then((e=>e.json())).then((s=>{if(200===s.status){const a=s.data._id;V(a),n()({title:"Success!",text:s.message,type:"success",icon:"success"}).then((function(){e("/ViewStaff")}))}else n()({title:"Error!",text:s.message,type:"error",icon:"error"}).then((function(){e("/ViewStaff")}))}))},children:[(0,i.jsxs)("div",{className:"row",children:[(0,i.jsx)("div",{className:"col-md-6",children:(0,i.jsxs)("div",{className:"form-group mb-3",children:[(0,i.jsx)("label",{children:"Name"}),(0,i.jsx)("input",{type:"text",className:"form-control",name:"staff_name",placeholder:"Enter Name",autoComplete:"off",required:!0})]})}),(0,i.jsx)("div",{className:"col-md-6",children:(0,i.jsxs)("div",{className:"form-group mb-3",children:[(0,i.jsx)("label",{children:"Email"}),(0,i.jsx)("input",{type:"email",className:"form-control",name:"staff_email",placeholder:"Enter Email",autoComplete:"off",required:!0})]})})]}),(0,i.jsxs)("div",{className:"row",children:[(0,i.jsx)("div",{className:"col-md-6",children:(0,i.jsxs)("div",{className:"form-group mb-3",children:[(0,i.jsx)("label",{children:"Mobile"}),(0,i.jsx)("input",{type:"text",className:"form-control",name:"staff_mobile",placeholder:"Enter Mobile",autoComplete:"off",required:!0})]})}),(0,i.jsx)("div",{className:"col-md-6",children:(0,i.jsxs)("div",{className:"form-group mb-3",children:[(0,i.jsx)("label",{children:"User Type"}),(0,i.jsxs)("select",{className:"form-control",onClick:e=>(e=>{"653604248028cba2487f7d2a"===e.target.value?y(!0):y(!1)})(e),name:"staff_usertype",required:!0,children:[(0,i.jsx)("option",{value:"",children:"Select User Type"}),d.length>0&&d.map(((e,s)=>(0,i.jsx)("option",{value:e._id,children:e.usertype},s)))]})]})}),1==N?(0,i.jsx)("div",{className:"col-md-6",children:(0,i.jsxs)("div",{className:"form-group mb-3",children:[(0,i.jsx)("label",{children:"Company"}),(0,i.jsxs)("select",{className:"form-control",name:"company",required:!0,children:[(0,i.jsx)("option",{value:"",children:"Select Company"}),null===S||void 0===S?void 0:S.map(((e,s)=>(0,i.jsx)("option",{value:e._id,children:e.company_name},s)))]})]})}):""]}),(0,i.jsxs)("div",{className:"row",children:[(0,i.jsx)("div",{className:"col-md-6",children:(0,i.jsxs)("div",{className:"form-group mb-3",children:[(0,i.jsx)("label",{children:"Location"}),(0,i.jsx)(c.default,{options:s,displayValue:"label",selectedValues:u,onSelect:e=>E(e),onRemove:e=>E(e),placeholder:"Select Location",closeOnSelect:!1,avoidHighlightFirstOption:!0,showCheckbox:!0,style:{chips:{background:"#007bff"}}})]})}),(0,i.jsx)("div",{className:"col-md-6",children:(0,i.jsxs)("div",{className:"form-group mb-3",children:[(0,i.jsx)("label",{children:"Line Of Business"}),(0,i.jsx)(c.default,{options:o,displayValue:"label",selectedValues:o,onSelect:p,onRemove:p,placeholder:"Select Line Of Business",closeOnSelect:!1,avoidHighlightFirstOption:!0,showCheckbox:!0,style:{chips:{background:"#007bff"}}})]})})]}),(0,i.jsxs)("div",{className:"row",children:[(0,i.jsx)("div",{className:"col-md-6",children:(0,i.jsxs)("div",{className:"form-group mb-3",children:[(0,i.jsx)("label",{children:"Type"}),(0,i.jsx)(c.default,{options:j,displayValue:"label",onSelect:b,onRemove:b,placeholder:"Select Type",closeOnSelect:!1,avoidHighlightFirstOption:!0,showCheckbox:!0,style:{chips:{background:"#007bff"}}})]})}),(0,i.jsx)("div",{className:"col-md-6",children:(0,i.jsxs)("div",{className:"form-group mb-3",children:[(0,i.jsx)("label",{children:"Password"}),(0,i.jsx)("input",{type:"password",className:"form-control",name:"staff_password",placeholder:"Enter Password"})]})})]}),(0,i.jsx)("div",{className:"row",children:(0,i.jsx)("div",{className:"col-md-12",style:{textAlign:"right"},children:(0,i.jsx)("button",{type:"submit",className:"btn btn-primary",children:"Save"})})})]})})]})})})})})})}}}]);
//# sourceMappingURL=2329.170f2efe.chunk.js.map