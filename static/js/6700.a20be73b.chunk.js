"use strict";(self.webpackChunk_coreui_coreui_free_react_admin_template=self.webpackChunk_coreui_coreui_free_react_admin_template||[]).push([[6700],{96700:(e,s,l)=>{l.r(s),l.d(s,{default:()=>i});var n=l(65043),t=l(73216),o=l(73023),a=l.n(o),d=l(70579);const i=()=>{const e=(0,t.Zp)(),[s,l]=(0,n.useState)([]),[o,i]=(0,n.useState)([]),[c,r]=(0,n.useState)([]),[m,u]=(0,n.useState)("");(0,n.useEffect)((()=>{let s=localStorage.getItem("token");""===s||null===s||void 0===s?e("/login"):(h(),_())}),[]);const h=()=>{fetch("https://insuranceapi-3o5t.onrender.com/api/getmodule",{method:"GET",headers:{"Content-Type":"application/json"}}).then((e=>e.json())).then((e=>{console.log(e.data),l(e.data)}))},p=(e,s,n)=>{const t=n.target.checked;l((l=>l.map((l=>({...l,sub_module:l.sub_module.map((l=>l.sub_module_name===e?{...l,[s]:t?1:0}:l))}))))),i((l=>l.map((l=>{if(l.module_name===e){return{...l,permission:[{...l.permission[0],[e]:[s]}]}}return l}))))},_=()=>{fetch("https://insuranceapi-3o5t.onrender.com/api/get_user_type",{method:"GET",headers:{"Content-Type":"application/json"}}).then((e=>e.json())).then((e=>{r(e.data)}))},j=e=>{u(e),(e=>{fetch(`https://insuranceapi-3o5t.onrender.com/api/getAllPermission/${e}`,{method:"GET",headers:{"Content-Type":"application/json"}}).then((e=>e.json())).then((e=>{console.log(e.data),i(e.data)}))})(e)};return console.log("permission>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>",o),console.log("data>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>",s),(0,d.jsx)("div",{className:"container",children:(0,d.jsx)("div",{className:"row",children:(0,d.jsx)("div",{className:"col-12",children:(0,d.jsxs)("div",{className:"card card-default",children:[(0,d.jsx)("div",{className:"card-header justify-content-center",children:(0,d.jsx)("div",{className:"row",children:(0,d.jsx)("div",{className:"col-md-6",children:(0,d.jsx)("h4",{children:"Global User Management System"})})})}),(0,d.jsxs)("div",{className:"card-body",children:[(0,d.jsx)("div",{className:"row",children:(0,d.jsx)("div",{className:"col-md-12",children:(0,d.jsxs)("div",{className:"form-group mb-3",children:[(0,d.jsx)("label",{children:"User Type"}),(0,d.jsxs)("select",{className:"form-control",name:"usertype",onChange:e=>j(e.target.value),required:!0,children:[(0,d.jsx)("option",{hidden:!0,children:"Select User Type"}),c.length>0&&c.map(((e,s)=>(0,d.jsx)("option",{value:e._id,children:e.usertype},s)))]})]})})}),(0,d.jsx)("div",{className:"row",children:(0,d.jsx)("div",{className:"col-md-12",children:(0,d.jsx)("button",{type:"submit",className:"btn btn-primary mt-2",style:{float:"right"},onClick:()=>{const e={};s.forEach((s=>{const l=[];s.sub_module.forEach((e=>{const s={[e.sub_module_name]:[]};Object.entries(e).forEach((l=>{let[n,t]=l;"sub_module_name"!==n&&s[e.sub_module_name].push({key:n,value:t?1:0})})),l.push(s)})),e[s.module_name]=l})),e.user_type_id=m,(async e=>{console.log("permissionData>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>",e);try{const s={method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)},l=await fetch("https://insuranceapi-3o5t.onrender.com/api/update_model_permission",s),n=await l.json();200===n.status?a()({title:"Success!",text:n.message,type:"success",icon:"success"}).then((()=>{h(),_()})):a()({title:"Error!",text:n.message,type:"error",icon:"error"}).then((()=>{window.location.href="/global-user-management-permissions"}))}catch(s){console.log(s)}})(e)},children:"Submit"})})})]}),(0,d.jsx)("div",{className:"card-body",children:(0,d.jsx)("div",{className:"row",children:(0,d.jsx)("div",{className:"col-md-12",children:(0,d.jsxs)("table",{className:"table table-bordered admin_abcdsd",children:[(0,d.jsx)("thead",{children:(0,d.jsxs)("tr",{children:[(0,d.jsx)("th",{children:"Module"}),(0,d.jsx)("th",{children:"Task And Activity"}),(0,d.jsx)("th",{children:"Create"}),(0,d.jsx)("th",{children:"Edit"}),(0,d.jsx)("th",{children:"Delete"}),(0,d.jsx)("th",{children:"View"}),(0,d.jsx)("th",{children:"Download"}),(0,d.jsx)("th",{children:"Export"}),(0,d.jsx)("th",{children:"Upload"})]})}),(0,d.jsx)("tbody",{children:s.flatMap(((e,s)=>(0,d.jsxs)("tr",{children:[(0,d.jsx)("td",{children:e.module_name}),(0,d.jsx)("td",{children:(0,d.jsx)("ul",{children:e.sub_module.map(((e,s)=>(0,d.jsx)("li",{children:e.sub_module_name},s)))})}),(0,d.jsx)("td",{children:(0,d.jsx)("ul",{children:e.sub_module.map(((s,l)=>(console.log(o.filter((s=>s.module_name===e.module_name)).flatMap((e=>{const l=s.sub_module_name.toLowerCase().split(" ").join("_");console.log("subModuleName",l);const n=e.permission[0];return console.log("userPermission",n),!(!n||!n[l])&&n[l].includes("create")}))[0],">>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>"),(0,d.jsx)("li",{children:(0,d.jsx)("input",{type:"checkbox",defaultChecked:o.filter((s=>s.module_name===e.module_name)).flatMap((e=>{const l=s.sub_module_name.toLowerCase().split(" ").join("_"),n=e.permission[0];return!(!n||!n[l])&&n[l].includes("create")}))[0],onClick:e=>p(s.sub_module_name,"create",e)})},l))))})}),(0,d.jsx)("td",{children:(0,d.jsx)("ul",{children:e.sub_module.map(((s,l)=>(0,d.jsx)("li",{children:(0,d.jsx)("input",{type:"checkbox",defaultChecked:o.filter((s=>s.module_name===e.module_name)).flatMap((e=>{const l=s.sub_module_name.toLowerCase().split(" ").join("_"),n=e.permission[0];return!(!n||!n[l])&&n[l].includes("edit")}))[0],onClick:e=>p(s.sub_module_name,"edit",e)})},l)))})}),(0,d.jsx)("td",{children:(0,d.jsx)("ul",{children:e.sub_module.map(((s,l)=>(0,d.jsx)("li",{children:(0,d.jsx)("input",{type:"checkbox",defaultChecked:o.filter((s=>s.module_name===e.module_name)).flatMap((e=>{const l=s.sub_module_name.toLowerCase().split(" ").join("_"),n=e.permission[0];return!(!n||!n[l])&&n[l].includes("delete")}))[0],onClick:e=>p(s.sub_module_name,"delete",e)})},l)))})}),(0,d.jsx)("td",{children:(0,d.jsx)("ul",{children:e.sub_module.map(((s,l)=>(0,d.jsx)("li",{children:(0,d.jsx)("input",{type:"checkbox",defaultChecked:o.filter((s=>s.module_name===e.module_name)).flatMap((e=>{const l=s.sub_module_name.toLowerCase().split(" ").join("_"),n=e.permission[0];return!(!n||!n[l])&&n[l].includes("view")}))[0],onClick:e=>p(s.sub_module_name,"view",e)})},l)))})}),(0,d.jsx)("td",{children:(0,d.jsx)("ul",{children:e.sub_module.map(((s,l)=>(0,d.jsx)("li",{children:(0,d.jsx)("input",{type:"checkbox",defaultChecked:o.filter((s=>s.module_name===e.module_name)).flatMap((e=>{const l=s.sub_module_name.toLowerCase().split(" ").join("_"),n=e.permission[0];return!(!n||!n[l])&&n[l].includes("download")}))[0],onClick:e=>p(s.sub_module_name,"download",e)})},l)))})}),(0,d.jsx)("td",{children:(0,d.jsx)("ul",{children:e.sub_module.map(((s,l)=>(0,d.jsx)("li",{children:(0,d.jsx)("input",{type:"checkbox",defaultChecked:o.filter((s=>s.module_name===e.module_name)).flatMap((e=>{const l=s.sub_module_name.toLowerCase().split(" ").join("_"),n=e.permission[0];return!(!n||!n[l])&&n[l].includes("export")}))[0],onClick:e=>p(s.sub_module_name,"export",e)})},l)))})}),(0,d.jsx)("td",{children:(0,d.jsx)("ul",{children:e.sub_module.map(((s,l)=>(0,d.jsx)("li",{children:(0,d.jsx)("input",{type:"checkbox",defaultChecked:o.filter((s=>s.module_name===e.module_name)).flatMap((e=>{const l=s.sub_module_name.toLowerCase().split(" ").join("_"),n=e.permission[0];return!(!n||!n[l])&&n[l].includes("upload")}))[0],onClick:e=>p(s.sub_module_name,"upload",e)})},l)))})})]},s)))})]})})})})]})})})})}}}]);
//# sourceMappingURL=6700.a20be73b.chunk.js.map