"use strict";(self.webpackChunk_coreui_coreui_free_react_admin_template=self.webpackChunk_coreui_coreui_free_react_admin_template||[]).push([[7086],{37086:(e,s,t)=>{t.r(s),t.d(s,{default:()=>f});var l=t(65043),a=t(53519),o=t(84217),n=t(14282),c=t(73216),i=t(92157),d=t.n(i),r=(t(65089),t(93946)),u=(t(72450),t(11238),t(73023)),h=t.n(u),m=t(54168),p=t(31899),x=t.n(p),j=(t(25015),t(70579));const f=()=>{var e;const s=(0,c.Zp)(),[t,i]=(0,l.useState)([]),[u]=(0,l.useState)(10),[p,f]=(0,l.useState)(0),[v,y]=(0,l.useState)(1),[g,b]=(0,l.useState)(""),[N,_]=(0,l.useState)(""),[C,S]=(0,l.useState)(""),[D,w]=(0,l.useState)(""),[A,k]=(0,l.useState)(!1),[E,V]=(0,l.useState)(!1),[T,O]=(0,l.useState)(!1),[F,P]=(0,l.useState)([]);(0,l.useEffect)((()=>{const e=localStorage.getItem("token");if(null===e||void 0===e||""===e)s("/login");else{var t;ne(v,u);const e=JSON.parse(localStorage.getItem("user")),s=(null===e||void 0===e||null===(t=e.master_permission)||void 0===t?void 0:t[0])||{};P(s),te(),le()}}),[]);const[H,I]=(0,l.useState)([]),[L,M]=(0,l.useState)([]),[q,J]=(0,l.useState)([]),[R,U]=(0,l.useState)([]),[B,z]=(0,l.useState)(""),[G,W]=(0,l.useState)(""),[Q,$]=(0,l.useState)(""),[Z,K]=(0,l.useState)(new Date),[X,Y]=(0,l.useState)(new Date),[ee,se]=(0,l.useState)(""),te=()=>{fetch("https://insuranceapi-3o5t.onrender.com/api/getCustomerlist",{method:"GET",headers:{"Content-Type":"application/json"}}).then((e=>e.json())).then((e=>{const s=null===e||void 0===e?void 0:e.data,t=[];for(let a=0;a<(null===s||void 0===s?void 0:s.length);a++){var l;null!=(null===(l=s[a])||void 0===l?void 0:l.email)&&t.push({label:s[a].email,value:s[a]._id})}I(t)}))},le=()=>{fetch("https://insuranceapi-3o5t.onrender.com/api/get_line_of_business_list",{method:"GET",headers:{"Content-Type":"application/json"}}).then((e=>e.json())).then((e=>{const s=e.data.map((e=>({label:e.line_of_business_name,value:e._id})));J(s)}))};console.log(q);const ae=e=>{console.log(">>>>>>>>>>selectedItems",e),M(e)},oe=e=>{U(e)},ne=(e,s)=>{i([]);fetch(`https://insuranceapi-3o5t.onrender.com/api/get_special_offer/${s}/${e}`,{method:"GET",headers:{"Content-Type":"application/json"}}).then((e=>e.json())).then((e=>{const t=e.total/s,l=Math.ceil(t);f(l);const a=e.data;i(a)}))};console.log(t);const ce=async(e,s)=>{let t=await fetch("https://insuranceapi-3o5t.onrender.com/api/update_special_offer",{method:"put",body:JSON.stringify({ParamValue:e,status:s}),headers:{"Content-Type":"application/json"}});t=await t.json(),h()("Updated Succesfully","","success"),ne(v,u)},[ie,de]=(0,l.useState)([]),[re,ue]=(0,l.useState)(),[he,me]=(0,l.useState)(),[pe,xe]=(0,l.useState)(""),[je,fe]=(0,l.useState)(""),[ve,ye]=(0,l.useState)(""),[ge,be]=(0,l.useState)(new Date),[Ne,_e]=(0,l.useState)(new Date),[Ce,Se]=(0,l.useState)(""),De=(v-1)*u;return(0,j.jsxs)(j.Fragment,{children:[(0,j.jsx)(a.A,{children:(0,j.jsxs)("div",{className:"card mb-4",children:[(0,j.jsx)("div",{className:"card-header",children:(0,j.jsxs)("div",{className:"row",children:[(0,j.jsx)("div",{className:"col-md-6",children:(0,j.jsx)("h4",{className:"card-title",children:"Special Offers"})}),(0,j.jsx)("div",{className:"col-md-6",children:null!==F&&void 0!==F&&null!==(e=F.special_offers)&&void 0!==e&&e.includes("create")?(0,j.jsx)("button",{className:"btn btn-primary",style:{float:"right"},onClick:()=>V(!0),children:"Add Special Offers"}):""})]})}),(0,j.jsxs)("div",{className:"card-body",children:[(0,j.jsxs)("table",{className:"table table-bordered",children:[(0,j.jsx)("thead",{className:"thead-dark",children:(0,j.jsxs)("tr",{className:"table-info",children:[(0,j.jsx)("th",{scope:"col",children:"#"}),(0,j.jsx)("th",{scope:"col",children:"policy_type"}),(0,j.jsx)("th",{scope:"col",children:"discount_amount"}),(0,j.jsx)("th",{scope:"col",children:"discount_code"}),(0,j.jsx)("th",{scope:"col",children:"description"}),(0,j.jsx)("th",{scope:"col",children:"startDate"}),(0,j.jsx)("th",{scope:"col",children:"endDate"}),(0,j.jsx)("th",{scope:"col",children:"Status"}),(0,j.jsx)("th",{scope:"col",children:"Action"})]})}),(0,j.jsx)("tbody",{children:(null===t||void 0===t?void 0:t.length)>0?t.map(((e,s)=>{var t,l,a;return(0,j.jsxs)("tr",{children:[(0,j.jsx)("td",{children:De+s+1}),(0,j.jsx)("td",{children:null===(t=e.policy_type)||void 0===t?void 0:t.map((e=>e.line_of_business_name))}),(0,j.jsx)("td",{children:e.discount_amount}),(0,j.jsx)("td",{children:e.discount_code}),(0,j.jsx)("td",{children:e.description}),(0,j.jsx)("td",{children:new Date(e.startDate).toLocaleString()}),(0,j.jsx)("td",{children:new Date(e.endDate).toLocaleString()}),(0,j.jsx)("td",{children:1==e.status?"Active":"Inactive"}),(0,j.jsxs)("td",{children:[(null===F||void 0===F||null===(l=F.special_offers)||void 0===l?void 0:l.includes("edit"))&&(0,j.jsx)("button",{className:"btn btn-primary",onClick:()=>(async e=>{var s;w(e);let t=await fetch("https://insuranceapi-3o5t.onrender.com/api/get_special_offer_by_id",{method:"post",body:JSON.stringify({ParamValue:e}),headers:{"Content-Type":"application/json"}});t=await t.json(),de(t.data);const l=null===(s=t.data)||void 0===s?void 0:s.userId,a=H.filter((e=>l.includes(e.value))).map((e=>({label:e.label,value:e.value})));M(a);const o=t.data.policy_type,n=q.filter((e=>o.includes(e.value))).map((e=>({label:e.label,value:e.value})));U(n),be(t.data.startDate),_e(t.data.endDate),O(!0)})(e._id),children:"Edit"})," ",(null===F||void 0===F||null===(a=F.special_offers)||void 0===a?void 0:a.includes("delete"))&&(0,j.jsx)(j.Fragment,{children:!0===e.status?(0,j.jsx)("button",{className:"btn btn-danger",onClick:()=>{window.confirm("Are you sure you wish to deactivate this item?")&&ce(e._id,!1)},children:"Deactivate"}):(0,j.jsx)("button",{className:"btn btn-success",onClick:()=>{window.confirm("Are you sure you wish to activate this item?")&&ce(e._id,!0)},children:"Activate"})})]})]},s)})):(0,j.jsx)("tr",{children:(0,j.jsx)("td",{colSpan:"6",children:"No Data Found"})})})]}),(0,j.jsx)(d(),{previousLabel:"Previous",nextLabel:"Next",breakLabel:"...",pageCount:p,marginPagesDisplayed:2,pageRangeDisplayed:3,onPageChange:e=>{const s=e.selected;y(s+1),ne(s+1,u)},containerClassName:"pagination justify-content-end",pageClassName:"page-item",pageLinkClassName:"page-link",previousClassName:"page-item",previousLinkClassName:"page-link",nextClassName:"page-item",nextLinkClassName:"page-link",breakClassName:"page-item",breakLinkClassName:"page-link",activeClassName:"active"})]})]})}),(0,j.jsxs)(r.zS,{alignment:"center",visible:A,onClose:()=>k(!1),children:[(0,j.jsx)(r.E4,{onClose:()=>k(!1),children:(0,j.jsx)(r.lb,{children:"Upload Excel File"})}),(0,j.jsx)(r.Tc,{children:(0,j.jsx)("div",{children:(0,j.jsx)("input",{type:"file",className:"form-control",id:"DHA",defaultValue:"",required:!0,onChange:e=>b(e.target.files[0])})})}),(0,j.jsxs)(r.If,{children:[(0,j.jsx)(r.Q_,{color:"secondary",onClick:()=>k(!1),children:"Close"}),(0,j.jsx)(r.Q_,{color:"primary",onClick:async e=>{e.preventDefault();const s=new FormData;s.append("file",g);await fetch("https://insuranceapi-3o5t.onrender.com/api/read_user_type_excel ",{method:"post",body:s}).then((e=>e.json())).then((e=>{200==e.status?(k(!A),h()({title:"Wow!",text:e.message,type:"success",icon:"success"}).then((function(){ne(v,u)}))):(k(!A),h()({title:"Error!",text:e.message,type:"error",icon:"error"}).then((function(){ne(v,u)})))}))},href:"/Viewtraveltype",children:"Upload"})]})]}),(0,j.jsxs)(o.A,{size:"lg",show:E,onHide:()=>V(!1),children:[(0,j.jsx)(o.A.Header,{closeButton:!0,children:(0,j.jsx)(o.A.Title,{children:"Add Special Offers"})}),(0,j.jsx)(o.A.Body,{children:(0,j.jsx)("div",{className:"container",children:(0,j.jsx)("div",{className:"row",children:(0,j.jsx)("div",{className:"col-md-12",children:(0,j.jsx)("div",{className:"card",children:(0,j.jsx)("div",{className:"card-body",children:(0,j.jsxs)("form",{children:[(0,j.jsxs)("div",{className:"row",children:[(0,j.jsxs)("div",{className:"col-md-6",children:[(0,j.jsx)("label",{className:"form-label",children:(0,j.jsx)("strong",{children:"Add User"})}),(0,j.jsx)(m.default,{options:H,displayValue:"label",onSelect:M,onRemove:M,placeholder:"Select Customer",showCheckbox:!0,avoidHighlightFirstOption:!0,style:{chips:{background:"#007bff"}},showArrow:!0})]}),(0,j.jsxs)("div",{className:"col-md-6",children:[(0,j.jsx)("label",{className:"form-label",children:(0,j.jsx)("strong",{children:"Add Policy Type"})}),(0,j.jsx)(m.default,{options:q,displayValue:"label",selectedValues:R,onSelect:U,onRemove:U,placeholder:"Select Policy Type",showCheckbox:!0,avoidHighlightFirstOption:!0,style:{chips:{background:"#007bff"}},showArrow:!0})]}),(0,j.jsxs)("div",{className:"col-md-6",children:[(0,j.jsx)("label",{className:"form-label",children:(0,j.jsx)("strong",{children:"Add Discount Amount"})}),(0,j.jsx)("input",{type:"text",className:"form-control",name:"usertype",placeholder:"Enter Discount Amount",defaultValue:"",required:!0,autoComplete:"off",onChange:e=>z(e.target.value)})]}),(0,j.jsxs)("div",{className:"col-md-6",children:[(0,j.jsx)("label",{className:"form-label",children:(0,j.jsx)("strong",{children:"Add Discount Code"})}),(0,j.jsx)("input",{type:"text",className:"form-control",name:"usertype",placeholder:"Discount Code",defaultValue:"",required:!0,autoComplete:"off",onChange:e=>W(e.target.value)})]}),(0,j.jsxs)("div",{className:"col-md-6",children:[(0,j.jsx)("label",{className:"form-label",children:(0,j.jsx)("strong",{children:"Add Description"})}),(0,j.jsx)("input",{type:"text",className:"form-control",name:"usertype",placeholder:"Enter Description",defaultValue:"",required:!0,autoComplete:"off",onChange:e=>$(e.target.value)})]}),(0,j.jsxs)("div",{className:"col-md-6",children:[(0,j.jsx)("label",{className:"form-label",children:(0,j.jsx)("strong",{children:"Add Start Date"})}),(0,j.jsx)("br",{}),(0,j.jsx)(x(),{className:"form-control",selected:Z,format:"dd/MM/yyyy",onChange:e=>K(e)})]}),(0,j.jsxs)("div",{className:"col-md-6",children:[(0,j.jsx)("label",{className:"form-label",children:(0,j.jsx)("strong",{children:"Add End Date"})}),(0,j.jsx)("br",{}),(0,j.jsx)(x(),{className:"form-control",selected:X,format:"dd/MM/yyyy",onChange:e=>Y(e)})]})]}),(0,j.jsx)("div",{className:"row",children:(0,j.jsx)("div",{className:"col-md-12",children:(0,j.jsx)("button",{type:"submit",className:"btn btn-primary mt-2 submit_all",style:{float:"right"},onClick:async e=>{e.preventDefault(),console.log(">>>>>>>>>>selectedcustomer",L.map((e=>e.value))),console.log(">>>>>>>>>>selectedlob",R.map((e=>e.value))),console.log(">>>>>>>>>>discount_type",B),console.log(">>>>>>>>>>discount_code",G),console.log(">>>>>>>>>>description",Q),console.log(">>>>>>>>>>startDate",Z),console.log(">>>>>>>>>>endDate",X),await fetch("https://insuranceapi-3o5t.onrender.com/api/add_special_offer",{method:"post",body:JSON.stringify({userId:L.map((e=>e.value)),policy_type:R.map((e=>e.value)),discount_amount:B,discount_code:G,description:Q,startDate:Z,endDate:X}),headers:{"Content-Type":"application/json"}}).then((e=>e.json())).then((e=>{200==e.status?(V(!1),h()({title:"Wow!",text:e.message,type:"success",icon:"success"}).then((function(){ne(v,u)}))):(V(!1),h()({title:"Error!",text:e.message,type:"error",icon:"error"}).then((function(){ne(v,u)})))}))},children:"Submit"})})})]})})})})})})}),(0,j.jsx)(o.A.Footer,{children:(0,j.jsx)(n.A,{variant:"secondary",onClick:()=>V(!1),children:"Close"})})]}),(0,j.jsxs)(o.A,{size:"lg",show:T,onHide:()=>O(!1),children:[(0,j.jsx)(o.A.Header,{closeButton:!0,children:(0,j.jsx)(o.A.Title,{children:"Edit Special Offer"})}),(0,j.jsx)(o.A.Body,{children:(0,j.jsx)("div",{className:"container",children:(0,j.jsx)("div",{className:"row",children:(0,j.jsx)("div",{className:"col-md-12",children:(0,j.jsx)("div",{className:"card",children:(0,j.jsx)("div",{className:"card-body",children:(0,j.jsxs)("form",{children:[(0,j.jsxs)("div",{className:"row",children:[(0,j.jsxs)("div",{className:"col-md-6",children:[(0,j.jsx)("label",{className:"form-label",children:(0,j.jsx)("strong",{children:"Edit User"})}),(0,j.jsx)(m.default,{options:H,displayValue:"label",selectedValues:L,onSelect:ae,onRemove:ae,placeholder:"Select Customer",showCheckbox:!0,avoidHighlightFirstOption:!0,style:{chips:{background:"#007bff"}},showArrow:!0})]}),(0,j.jsxs)("div",{className:"col-md-6",children:[(0,j.jsx)("label",{className:"form-label",children:(0,j.jsx)("strong",{children:"Edit Policy Type"})}),(0,j.jsx)(m.default,{options:q,displayValue:"label",selectedValues:R,onSelect:oe,onRemove:oe,placeholder:"Select Policy Type",showCheckbox:!0,avoidHighlightFirstOption:!0,style:{chips:{background:"#007bff"}},showArrow:!0})]}),(0,j.jsxs)("div",{className:"col-md-6",children:[(0,j.jsx)("label",{className:"form-label",children:(0,j.jsx)("strong",{children:"Edit Discount Amount"})}),(0,j.jsx)("input",{type:"text",className:"form-control",name:"usertype",placeholder:"Enter Discount Amount",defaultValue:ie.discount_amount,required:!0,autoComplete:"off",onChange:e=>xe(e.target.value)})]}),(0,j.jsxs)("div",{className:"col-md-6",children:[(0,j.jsx)("label",{className:"form-label",children:(0,j.jsx)("strong",{children:"Edit Discount Code"})}),(0,j.jsx)("input",{type:"text",className:"form-control",name:"usertype",placeholder:"Discount Code",defaultValue:ie.discount_code,required:!0,autoComplete:"off",onChange:e=>fe(e.target.value)})]}),(0,j.jsxs)("div",{className:"col-md-6",children:[(0,j.jsx)("label",{className:"form-label",children:(0,j.jsx)("strong",{children:"Edit Description"})}),(0,j.jsx)("input",{type:"text",className:"form-control",name:"usertype",placeholder:"Enter Description",defaultValue:ie.description,required:!0,autoComplete:"off",onChange:e=>ye(e.target.value)})]}),(0,j.jsxs)("div",{className:"col-md-6",children:[(0,j.jsx)("label",{className:"form-label",children:(0,j.jsx)("strong",{children:"Edit Start Date"})}),(0,j.jsx)("br",{}),(0,j.jsx)(x(),{className:"form-control",selected:ge&&!isNaN(new Date(ge))?new Date(ge):null,format:"dd/MM/yyyy",onChange:e=>be(e)})]}),(0,j.jsxs)("div",{className:"col-md-6",children:[(0,j.jsx)("label",{className:"form-label",children:(0,j.jsx)("strong",{children:"Edit End Date"})}),(0,j.jsx)("br",{}),(0,j.jsx)(x(),{className:"form-control",selected:Ne&&!isNaN(new Date(Ne))?new Date(Ne):null,format:"dd/MM/yyyy",onChange:e=>_e(e)})]})]}),(0,j.jsx)("div",{className:"row",children:(0,j.jsx)("div",{className:"col-md-12",children:(0,j.jsx)("button",{type:"submit",className:"btn btn-primary mt-2 submit_all",style:{float:"right"},onClick:async e=>{e.preventDefault(),console.log(">>>>>>>>>>selectedcustomer",null===L||void 0===L?void 0:L.map((e=>e.value))),console.log(">>>>>>>>>>selectedlob",null===R||void 0===R?void 0:R.map((e=>e.value))),console.log(">>>>>>>>>>discount_type",pe||ie.discount_amount),console.log(">>>>>>>>>>discount_code",je||ie.discount_code),console.log(">>>>>>>>>>description",ve||ie.description),console.log(">>>>>>>>>>startDate",ge||ie.startDate),console.log(">>>>>>>>>>endDate",Ne||ie.endDate),await fetch("https://insuranceapi-3o5t.onrender.com/api/update_special_offer",{method:"put",body:JSON.stringify({ParamValue:D,userId:(null===L||void 0===L?void 0:L.map((e=>e.value)))||ie.userId,policy_type:(null===R||void 0===R?void 0:R.map((e=>e.value)))||ie.policy_type,discount_amount:pe||ie.discount_amount,discount_code:je||ie.discount_code,description:ve||ie.description,startDate:ge||ie.startDate,endDate:Ne||ie.endDate}),headers:{"Content-Type":"application/json"}}).then((e=>e.json())).then((e=>{200==e.status?(O(!1),h()({title:"Wow!",text:e.message,type:"success",icon:"success"}).then((function(){ne(v,u)}))):(O(!1),h()({title:"Error!",text:e.message,type:"error",icon:"error"}).then((function(){ne(v,u)})))}))},children:"Submit"})})})]})})})})})})}),(0,j.jsx)(o.A.Footer,{children:(0,j.jsx)(n.A,{variant:"secondary",onClick:()=>O(!1),children:"Close"})})]})]})}},65089:(e,s,t)=>{e.exports=t.p+"static/media/user-type.c2c5e619599c3c1e0784.xlsx"}}]);
//# sourceMappingURL=7086.6b7e50df.chunk.js.map